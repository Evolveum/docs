- id: '5.1'
  title: 'Policies for information security'
  category: organizational
  control: 'Information security policy and topic-specific policies should be defined, approved by management, published, communicated to and acknowledged by relevant personnel and relevant interested parties, and reviewed at planned intervals and if significant changes occur.'
  comment: 'Information security policy (top management), topic-specific policies'
  necessity: optional
  features: [ 'reporting', 'simulation', 'audit-trail', 'application-inventory', 'dashboard' ]
  igaCapabilities: [ 'identity-analytics' ]
  implementation:
      overview: >
          MidPoint can provide essential data for definition and maintenance of security policies.
      details: >
          MidPoint reporting can be used to extract information from identity data (identity analytics).
          Simulation capabilities can be used to predict the effect of proposed policies, especially for topic-specific policies.
          Dashboards can be used to keep track of application, enforcement and violations of the policies.
# Example: report for topic-specific policy?

- id: '5.2'
  title: 'Information security roles and responsibilities'
  category: organizational
  control: 'Information security roles and responsibilities should be defined and allocated according to the organization needs.'
  comment: 'RBAC, mostly for security personnel'
  necessity: necessary
  related: [ '5.1' ]
  features: [ 'rbac', 'role-governance', 'simulation', 'application-inventory', 'org', 'certification', 'escalation' ]
  igaCapabilities: [ 'policy-and-role-management' ]
  implementation:
      overview: >
          MidPoint provides essential management capabilities of roles and responsibilities by using its advanced role-based access control (RBAC) mechanisms.
      details: >
          Roles can be defined in midPoint, including all necessary privileges, role hierarchies, policies and descriptive data, especially for security personnel (e.g. security manager).
          Role governance can be managed in midPoint, recording business owners, custodians and approvers responsible for day-to-day operation.
          Such governance approach can be applied to roles, application catalog and other aspects of midPoint, getting governance closer to assets.
          Organizational structure can be used to assign collective responsibilities, e.g. common responsibilities and privileges of security teams.
          Escalation capability can be used to maintain accountability of upper management, making sure that the delegated responsibilities are conducted in a timely manner.
          Simulation capability can be used to predict effects of role model changes.
      rationale: >
          MidPoint is necessary for consistent application of security roles and responsibilities.
          Security personnel often have elevated privileges.
          MidPoint can make sure the privileges are properly recorded, that they are automatically revoked when needed, that the privileges are regularly re-certified.
          While, in theory, this can be done manually, it is not practical and there may be issues in consistent management of privileges and their timely revocation.
# TODO: needs more work, compare with other RBAC-related controls
# Example: (with 5.15, 5.18) Role owners, application owners, Security office team, ???

- id: '5.3'
  title: 'Segregation of duties'
  category: organizational
  control: 'Conflicting duties and conflicting areas of responsibility should be segregated.'
  comment: 'SoD'
  necessity: necessary
  features: [ 'sod', 'policy-rule', 'meta-role', 'gradual-policy-enforcement', 'approval-process', 'authorization', 'reporting' ]
  igaCapabilities: [ 'policy-and-role-management' ]
  igaFunctions: [ 'sod' ]
  implementation:
      overview: >
          MidPoint can manage, monitor and enforce segregation of duties (SoD) policies through the organization.
      details: >
          Segregation of duties (SoD) policies can be defined on role level (role exclusion) or role-class level (meta-role), with selective enforcement.
          The policies can be enforced gradually, reporting policy violations first, gradually addressing them, applying full policy enforcement when all violations are addressed.
          SoD violations can be optionally driven through approval process to "legalize" them.
      rationale: >
          MidPoint is necessary, as SoD policy cannot be practically enforced manually on large number of roles, and large number of role assignment changes.
          SoD evaluation and enforcement must be automated to be practical.
      plan: >
          Add SoD widget to pre-configured Compliance dashboard.
          Create sample and docs configurations for gradual SoD enforcement.
# Example: SoD gradual enforcement: define SoD policy, report violations, set up dashboard, clean up violations, enforce the policy
# CONFIG: pre-configured reports: SoD policies (roles with SoD exclusions), SoD violations

- id: '5.4'
  title: 'Management responsibilities'
  category: organizational
  control: 'Management should require all personnel to apply information security in accordance with the established information security policy, topic-specific policies and procedures of the organization.'
  necessity: not-applicable
  related: [ '6.3' ]

- id: '5.5'
  title: 'Contact with authorities'
  category: organizational
  control: 'The organization should establish and maintain contact with relevant authorities.'
  necessity: not-applicable
  related: [ '5.24', '5.28', '5.29', '5.30' ]

- id: '5.6'
  title: 'Contact with special interest groups'
  category: organizational
  control: 'The organization should establish and maintain contact with special interest groups or other specialist security forums and professional associations.'
  necessity: not-applicable
  related: [ '5.24', '5.28' ]

- id: '5.7'
  title: 'Threat intelligence'
  category: organizational
  control: 'Information relating to information security threats should be collected and analysed to produce threat intelligence.'
  necessity: marginal
  features: [ 'object-lifecycle', 'audit-trail', 'object-metadata', 'object-history', 'reporting' ]
  igaCapabilities: [ 'lifecycle' ]
  implementation:
      overview: >
          MidPoint can provide additional information for operational threat intelligence, such as current or past access rights of users affected by a threat.

- id: '5.8'
  title: 'Information security in project management'
  category: organizational
  control: 'Information security should be integrated into project management.'
  comment: 'Project management'
  necessity: necessary
  related: [ '5.12', '5.32', '8.26' ]
  features: [ 'org', 'archetype', 'delegated-administration', 'relation', 'authorization', 'information-classification', 'policy-rule' ]
  igaCapabilities: [ 'lifecycle', 'policy-and-role-management' ]
  igaFunctions: [ 'organizational-structure' ]
  implementation:
      overview: >
          MidPoint can manage projects as organizational units, including project governance information (managers, sponsors, reviewers).
      details: >
          Privileges necessary for project members and managers can be assigned automatically.
          As midPoint organizational structures act as roles (abstract roles), all necessary policies and privileges for project can be defined centrally (project meta-role or archetype) or on per-project level.
          Projects can be automatically represented by entitlements, e.g. automatically creating and managing Active Directory groups for projects.
          Information classification labels can be applied to projects, manually or automatically (
          Delegated administration can be used to allow project managers to control certain aspects of the projects (e.g. project name, description and membership).
          Policy rules can report or enforce validity and consistency of project structure, e.g. making sure that all projects have at least one manager.
      rationale: >
          MidPoint is necessary, as the project-related policies cannot be practically enforced manually on large number of roles, and large number of project membership changes.
          If not automated, access rights associated with the projects are usually assigned to users, and never removed.
          Retaining access rights related to closed projects and former project members usually result in  severe over-provisioning.
          Access control related to project management must be automated to be secure and practical.
      plan: >
          Add "project" as a built-in pre-configured archetype.
          Create sample and docs configurations for project management.
# Example: Project management: manage AD project groups, manage membership, authorizations for project manager to modify project (maybe members)

- id: '5.9'
  title: 'Inventory of information and other associated assets'
  category: organizational
  control: 'An inventory of information and other associated assets, including owners, should be developed and maintained.'
  comment: 'Asset management'
  necessity: optional
  related: [ '5.10', '5.12', '5.13' ]
  features: [ 'role-governance', 'application-inventory', 'relation' ]
  igaCapabilities: [ 'lifecycle' ]
  implementation:
      overview: >
          MidPoint can manage applications, roles and entitlements that are closely related to assets.
      details: >
          Application inventory capability of midPoint is essential first step to catalog assets.
          MidPoint capability to maintain various relations of objects can be used to track owners of applications, roles and other asset-related objects.
          Applications without owners can be reported.
          Applications can be classified, setting classification-specific requirements and policies on applications.
          Application roles are linked to the application, enabling application-level policies to be applied to all users using the application.
      plan: >
          Introduce "asset" as a first-class citizen in midPoint (later, in synergy with risk assessment).
# Example: Compliance dashboard: roles without owners, applications without owners, applications without classification.

- id: '5.10'
  title: 'Acceptable use of information and other associated assets'
  category: organizational
  control: 'Rules for the acceptable use and procedures for handling information and other associated assets should be identified, documented and implemented.'
  comment: 'Acceptable use of assets, informing users, recording access, marking and protecting media'
  necessity: optional
  related: [ '5.12', '5.18', '7.8', '7.10' ]
  features: [ 'assignment', 'assignment-metadata', 'audit-trail', 'object-metadata', 'object-history', 'notification' ]
  implementation:
      overview: >
          Audit trail, object history and meta-data can be used to record access rights information.
      details: >
          MidPoint assignments provide a record of authorized users of information, including meta-data recording reasons for assigning the rights.
          Notifications can be used to deliver guidance on acceptable use of the system at the moment the account is created on the system.
          MidPoint can use audit trail to record access rights of users that have or had access to assets.
          Object history feature can be used to reveal access rights or users related to an asset in the past.
      plan: >
          Provide ability to inform user when gaining a privilege, asking user to confirm acceptance of terms before assigning the privilege.
# Example: audit log analysis?

- id: '5.11'
  title: 'Return of assets'
  category: organizational
  control: 'Personnel and other interested parties as appropriate should return all the organization’s assets in their possession upon change or termination of their employment, contract or agreement.'
  necessity: marginal
  related: [ '5.18', '5.24', '7.14' ]
  comment: "license management? Device ownership tracking? \"Auth hardware\" - tokens"
  features: [ 'service', 'projection-link' ]
  implementation:
      overview: >
          MidPoint can record ownership of devices, tokens and licenses using the concept of "service".
      details: >
          Projection links can be used to link to device/token tracing in external systems (e.g. physical security systems).
# TODO: license management?

- id: '5.12'
  title: 'Classification of information'
  category: organizational
  control: 'Information should be classified according to the information security needs of the organization based on confidentiality, integrity, availability and relevant interested party requirements.'
  comment: 'Establishing classification policy ("rules"), classification scheme, accountability of asset owners'
  necessity: optional
  related: [ '5.13', '5.14' ]
  # Strong?
  features: [ 'information-classification', 'role-governance', 'rbac', 'policy-rule', 'archetype' ]
  implementation:
      overview: >
          MidPoint has a native information classification feature, which can be used to set up classification and clearance schemes.
      details: >
          There are pre-configured archetypes for classifications and clearances in midPoint, that can be used to build classification and clearance schemes.
          Policy rules can be used to set up requirements for individual classifications and applied transitively to all objects giving access to classified asset (usually roles).
          Classification is a generic mechanism, that can apply to variety of objects: roles, organizational units, projects and services.
          Role governance features can be used to track owners accountable for assets - and even custodians for individual classifications and clearances.
      notes:
          - >
              Control for access control (5.15) asks for consistency between access rights and classification (controls 5.12, 5.13), which is given in midPoint by employing policy rules in classifications.
# Maybe add SANS example for classification?
# Example: TLP protocol?
# TODO: access certification? Replacing classifications, not unassigning them.

- id: '5.13'
  title: 'Labelling of information'
  category: organizational
  control: 'An appropriate set of procedures for information labelling should be developed and implemented in accordance with the information classification scheme adopted by the organization.'
  comment: 'Implementing classification policy ("rules"), using classification scheme on applications, roles, etc.'
  necessity: optional
  related: [ '5.12', '5.14' ]
  features: [ 'information-classification', 'application-inventory', 'assignment', 'rbac' ] # TODO: admin-gui?
  implementation:
      overview: >
          Applications can be classified using the defined classification scheme.
      details: >
          Classification schemes can be applied to almost all midPoint objects, most notably applications and roles, efficiently creating information labels.
          Policies specified for the classifications can be enforced by using policy rules.
          Policy rules are applied transitively, even if classified applications are included in business roles.
      notes:
          - >
              Control for access control (5.15) asks for consistency between access rights and classification (controls 5.12, 5.13), which is given in midPoint by employing policy rules in classifications.
# TODO: waiting for better visibility of labels in GUI
# TODO: access certification? Replacing classifications, not unassigning them.

- id: '5.14'
  title: 'Information transfer'
  category: organizational
  control: 'Information transfer rules, procedures, or agreements should be in place for all types of transfer facilities within the organization and between the organization and other parties.'
  comment: 'Limiting information transfer to third parties, e.g. allow access to information only to internal users and externals with NDA'
  necessity: optional
  related: [ '5.10', '5.12', '5.13', '5.31', '5.32', '5.33', '5.34', '8.7', '8.24' ]
  features: [ 'information-classification', 'policy-rule', 'rbac', 'archetype' ]
  implementation:
      overview: >
          MidPoint can use classifications and policy rules to limit and partially control information transfer.
      details: >
          Policy rules can prohibit access to internal information to external users, or it may require appropriate non-disclosure agreements in place (in a form of clearance).

- id: '5.15'
  title: 'Access control'
  category: organizational
  control: 'Rules to control physical and logical access to information and other associated assets should be established and implemented based on business and information security requirements.'
  comment: 'Umbrella control, referencing many other controls'
  necessity: necessary
  related: [ '5.3', '5.10', '5.12', '5.13', '5.16', '5.17', '5.18', '5.31', '5.32', '5.33', '5.34', '7.2', '7.3', '7.4', '8.2', '8.3', '8.4', '8.5', '8.18', '8.26' ]
  features: [ 'rbac', 'pdrbac', 'entitlement', 'role-wizard', 'delegated-administration', 'application-concept', 'meta-role', 'parametric-role', 'sod', 'information-classification', 'policy-rule', 'audit-trail', 'object-history', 'access-certification', 'micro-certification', 'role-governance', 'approval-process', 'applicable-policies', 'access-request-process', 'nhi', 'simulation' ]
  implementation:
      overview: >
          Policy-driven role-based access control mechanism of midPoint can be used as a solid framework for a topic-specific policy on access control, especially the Policy-driven RBAC mechanism.
      details: >
          MidPoint roles can determine entitlements used to enforce access control rules on a fine level.
          Access control rules can be applied both to human users, and non-human identities.
          Role wizard can be used by owners of information to set up appropriate roles for controlling access to the information.
          Concept of application can be used to specify application-specific access control rules and policies.
          For special cases requiring complex and flexible configurations, parametric roles and meta-roles can be used.
          Segregation of duties (SoD) mechanism as well as other policy rules can be an integral part of access control policy, observing applicable legislation and contractual obligations.
          Access request process with appropriate approvals can be used to allow access in a controlled manner, certification mechanism can be used to review the access.
          Changes in access control policy are recorded in audit trail.
      rationale: >
          The main functionality of midPoint is focusing on the access control.
          This is a very important domain for midPoint and without using midPoint it may be hard for organizations to be compliant with this control.
          MidPoint can be the “one tool” needed to correctly manage access control policy from one place and it can provide proof regarding access control policy and the implemented reality.
      notes:
        - >
            This is an "umbrella" control, setting a general access control requirements, referencing numerous other controls to fill in the details.
            Implementation details are provided in the description of referenced controls.
            See the list of related controls for more information.
        - >
            Control description mentions "roles" and RBAC as a suggestion for access control mechanism.
            It also mentions elements of dynamic access control, which is represented in midPoint by the policy-driven RBAC concept.
        - >
            Control description asks for consistency between access rights and classification (controls 5.12, 5.13), which is given in midPoint by employing policy rules in classifications.
        - >
            Role wizard, together with delegated administration capabilities, can be essential tools to delegate definition of role-based policies to the business users.
            MidPoint's ability to pre-define policies (a.k.a. "applicable policies") can be used to pre-package policy elements for business people to attach to roles they prepare.
        - >
            Simulation capability is a powerful tool to predict changes in access control policy, avoiding costly and dangerous disasters.
# TODO: "segregation of access control functions"
# TODO: need-to-know, need-to-use and least privilege principles
# Example: (with 5.18) delegate creation of business roles, using role wizard
# Example: (with 5.18) use "applicable policies" to set up access-and-approval scheme. Use pre-congifured policies for app-owner and role-owner approval, setup of approval by manager.

- id: '5.16'
  title: 'Identity management'
  category: organizational
  control: 'The full life cycle of identities should be managed.'
  comment: 'identity lifecycle, identifier management, correlation'
  necessity: necessary
  related: [ '5.17', '5.18', '5.19' ]
  features: [ 'identity-lifecycle', 'projection-link', 'provisioning', 'schema-activation', 'projection-policy', 'common-identity-model', 'iteration', 'sequence', 'expression', 'mapping', 'identity-repository', 'resource-schema', 'correlation', 'approval-process', 'nhi', 'assignment', 'rbac', 'audit-trail', 'object-metadata', 'assignment-metadata', 'value-metadata', 'access-certification', 'information-classification', 'access-request-process', 'schema-activation', 'entitlement', 'nhi', 'application-inventory' ]
  implementation:
      overview: >
          MidPoint platform with all of its features is designed to support identity management and all its aspects.
      details: >
          MidPoint can manage complete identity lifecycle, including both human and non-human identities.
          MidPoint can make sure that "unique identification of individuals and systems", as required by the control, is applied consistently and comprehensively.
          Features related to identity lifecycle management and synchronization are primary features to implement this control.
          Inbound synchronization from HR system (or similar data source) is the usual method to make sure access is de-provisioned in a timely manner, as required by the control.
          MidPoint is a natural choice for aggregation and management of user attributes, organizational and group membership, supporting processes for change of information relating to identities.
          User clearances can be managed and re-certified in midPoint.
          Projection links, synchronization and correlation can be used to make sure the identities are not duplicated.
          Proper identity management mechanisms are applied to avoid use of shared identities.
          MidPoint is designed to fully address de-provisioning of access, as required by the control.
          Audit trail is used to record all identity-related events and configuration changes.
      rationale: >
          The main functionality of midPoint is focusing on the identity management and supporting the whole life cycle of identities with proper documentation of each step and logs.
          Customers can create procedures for providing and revoking access to information with proper verification and approval.
      notes:
          - >
              This is the primary control supporting deployment of midPoint in organizations.
              Almost all midPoint features are more or less related to this control.
          - >
              Requirements of this control reach beyond the scope of IGA, mostly to systems that act as a source of information for midPoint.
              E.g. the control asks for confirming of business requirements for an identity, verifying it and establishing an identity.
              When dealing with employee identities, this requirements is satisfied by the usual HR practices and processes.
              MidPoint is taking processed information from the HR systems, assuming that the requirements are already satisfied.
          - >
              Application inventory provides "unique identification of systems", it can also be used for partial management of non-human identities (service accounts).
# TODO: Example: synchronization with correlation

- id: '5.17'
  title: 'Authentication information'
  category: organizational
  control: 'Allocation and management of authentication information should be controlled by a management process, including advising personnel on the appropriate handling of authentication information.'
  comment: 'mostly password management'
  necessity: necessary
  related: [ '6.2', '8.24' ]
  relatedFrameworks: [ 'ISO24760' ]
  features: [ 'password-management', 'password-policy', 'audit-trail', 'self-service-gui', 'self-service-password-reset' ]
  implementation:
      overview: >
          MidPoint is designed to manage authentication information, especially passwords.
      details: >
          MidPoint is built to distribute authentication information to target systems, making sure that the passwords are strong and up-to-date.
          MidPoint self-service user interface can be used to manage authentication information by users, including interactive indication of password strength.
          Password complexity and lifetime policies can be specified, enforced and they can also be used to generate strong passwords.
          MidPoint can be used to quickly change password or deactivate accounts on all connected systems, in an event of password compromise.
          Events related to change of authentication information are recorded in audit trail.
      rationale: >
          MidPoint can improve authentication level in a company by centrally enforcing password policy thanks to its password management.
      notes:
          - >
              This control is mostly about password management, it does not deal much with non-password authentication or credentials.
              ISO/IEC 24760 is referenced for that.
          - >
              MidPoint relies on cooperation of an access management (AM/SSO) system to implement most of the authentication and enforcement capabilities.
              MidPoint can manage authentication information, such as passwords or passkeys.
              However, midPoint cannot efficiently deal with authentication itself, or aspect of credential management related to authentication, such as forcing password change on next log-in.
              This functionality has to be implemented in close cooperation with the authentication system.
          - >
              Management of initial passwords and self-service password resets do not have any ideal solution.
              There are numerous trade-offs and compromises to be made.
              The solution has to be custom made for every organization or environment.
              Please see discussion document linked below for more details.
# Example: force password change for a large group of users after security incident?


- id: '5.18'
  title: 'Access rights'
  category: organizational
  control: 'Access rights to information and other associated assets should be provisioned, reviewed, modified and removed in accordance with the organization’s topic-specific policy on and rules for access control.'
  comment: 'Execution of access control policies: request, approval, certification'
  necessity: necessary
  related: [ '5.3', '5.9', '5.12', '5.15', '5.20', '6.1', '6.2', '6.4', '6.5', '6.6' ]
  features: [ 'provisioning', 'pdrbac', 'entitlement', 'access-request-process', 'approval-process', 'application-inventory', 'role-governance', 'access-certification', 'micro-certification', 'assignment', 'assignment-metadata', 'schema-activation', 'policy-rule', 'sod', 'information-classification', 'org', 'role-autoassignment', 'inducement', 'audit-trail', 'object-history' ]
  implementation:
      overview: >
          MidPoint is an essential component to make sure access to information is provisioned, reviewed, modified and removed in accordance with policies.
      details: >
          Access request and approval process can be used to request access, subject the request to appropriate approvals, and automatically provision the access.
          The process makes sure that all relevant approvals are processes before access is granted, dynamically evaluating approval schemes based on individual role definitions.
          Temporal activation constraints ("from" and "to" timestamps) can be used to limit validity of the identity, as well as assignment of access rights to the identity.
          Certification capability can be used to review access rights at regular intervals.
          Moreover, midPoint automatically removes on inactivates access rights of entities who have left the organization.
          Application owners recorded in application inventory can be used as part of the access rights management, taking part in approval and review (certification) processes.
          MidPoint automatically evaluates all applicable policy rules, making sure that segregation of duties (SoD) and information classification rules are maintained.
          MidPoint naturally maintains a central record of all assigned access rights, including assignment meta-data: when was access requested, who has approved access, etc.
          Access rights can be automatically assigned and unassigned according to organizational structure membership, either by using inducement, or by using role autoassignment capability.
          Automatic review of access rights at the moment of organizational membership change can be implemented by micro-certification feature.
          All access right changes are recorded in the audit trail.
      notes:
          - >
              The control asks for consideration of reason of employment termination (among other aspects) for access rights de-provisioning.
              MidPoint is built to de-provision access rights immediately when it learns about employment change.
              However, HR data sources are often integrated using reconciliation, which may have significant time delays.
              Therefore, it should be considered to supplement reconciliation with live synchronization for the HR system.
              Alternatively, manual deactivation process should be established for users where the circumstances of termination of employment suggest elevated risk.
          - >
              The control suggests establishment of user access roles based on business requirements, also known as business roles.
              Role wizard, together with delegated administration capabilities, can be essential tools to delegate definition of business roles to the business users.
              This is yet another place in the standard that suggests use of RBAC.
          - >
              Control description describes access rights cloning (a.k.a. "assign rights as Mr. Smiths has") as an undesirable practice, recommending use of RBAC instead.
# Example: (with 5.15) Access request, approval of application owner, approval of role owner, approval of manager
# Example: (with 5.15) delegate creation of business roles, using role wizard
# Example: Certification campaigns. Maybe considering classification (privileged access rights certified more often).
# Example: inducement of access rights in orgstruct
# Example: micro-certification when org membership changes
# Example: manual deactivation of users, after high-risk termination of employment
# TODO: "segregating the roles of approval and implementation of the access rights"
# TODO: reason for termination


- id: '5.19'
  title: 'Information security in supplier relationships'
  category: organizational
  control: 'Processes and procedures should be defined and implemented to manage the information security risks associated with the use of supplier’s products or services.'
  comment: 'risks associated with the use of supplier’s products or services, internal procedures'
  necessity: optional
  related: [ '5.10', '5.11', '5.12', '5.13', '5.14' ]
  relatedFrameworks: [ 'ISO27036-2', 'GDPR' ]
  features: [ 'identity-lifecycle', 'archetype', 'provisioning', 'pdrbac', 'inducement', 'policy-rule', 'org', 'application-inventory', 'entitlement', 'access-certification', 'schema-activation', 'information-classification', 'notification' ]
  implementation:
      overview: >
          Supplier identities can be managed by midPoint, including their access rights and relation to supplier organizations.
      details: >
          Supplier identities, such as contractors or support engineers can be recorded in midPoint, using specific archetypes, applying specific policies (inducements in the archetypes, policy rules).
          MidPoint records all access granted to the supplier, allowing assessment of risk posed by individual supplier identities.
          Organizational structure can be used to group such external identities with respect to their mother companies, making sure all supplier identities and access rights are properly de-provisioned when contract with specific supplier is terminated.
          Classification can be used to limit supplier's access to classified information based on hard policy, e.g. prohibiting supplier identity to gain any role which gives access to systems classified as "sensitive".
          Application inventory can be used to catalog third-party (cloud) services used by the organization, including all entities that have access to them.
          Classifications can be used to categorize cloud services, according to provided level of security and sensitivity of information stored there.
          Notifications can be used to communicate security policies and rules for acceptable use of information to suppliers, when gaining access to systems.
      rationale: >
          MidPoint can manage access rights of suppliers, e.g., by creating temporary access rights automatically revoked on expired date,
          by creating a business role especially created for a specific supplier that can be easily monitored (who has access to that role) and revoked.
      notes:
          - >
              Personal information protection should be considered when working with supplier, especially if cross-border transfer is involved,
              even more importantly in case of information transfer outside EU (see GDPR).
              MidPoint can provide an advantage in case that all personal information transfer is mediated by midPoint, as midPoint maintains record of information transfer,
              and it can also make sure that information erasure is properly initiated.
# TODO: license management

- id: '5.20'
  title: 'Addressing information security within supplier agreements'
  category: organizational
  control: 'Relevant information security requirements should be established and agreed with each supplier based on the type of supplier relationship.'
  comment: 'making sure suppliers have the right contractual obligations, incident management'
  necessity: optional
  related: [ '5.10', '5.12', '5.13', '5.14' ]
  relatedFrameworks: [ 'ISO27036-2', 'ISO19086', 'GDPR' ]
  features: [ 'identity-lifecycle', 'archetype', 'password-management', 'application-inventory', 'information-classification', 'audit-trail', 'object-history' ]
  implementation:
      overview: >
          Some of the supplier contractual agreements can be enforced by midPoint policies.
      details: >
          This controls deals mostly with contractual obligations, not so much with technical controls and measures.
          Most of the measures described in control 5.19 can be used to implement the contractual clauses of this control.
          MidPoint can make sure that access is granted to supplier identities only after all necessary contracts are in place (using clearance mechanism),
          e.g. only allowing access to users that have signed personal non-disclosure agreements.
          Audit trail and object history features can provide valuable information during management of incidents involving supplier identities and actions.
# TODO: license management


- id: '5.21'
  title: 'Managing information security in the ICT supply chain'
  category: organizational
  control: 'Processes and procedures should be defined and implemented to manage the information security risks associated with the ICT products and services supply chain.'
  comment: 'Product and service certification (CC), SBOM, anti-tampering, including cloud and IoT; mostly contractual'
  necessity: marginal
  related: [ '5.10', '5.12', '5.13', '5.14', '5.19', '5.20' ]
  relatedFrameworks: [ 'ISO27036-3', 'ISO19770-2', 'CC', 'CRA' ]
  features: [ 'application-inventory', 'information-classification', 'policy-rule' ]
  implementation:
      overview: >
          MidPoint can provide inventory of applications, including their classifications.
      details: >
          This controls deals mostly with contractual obligations and organizational procedures, not so much with technical controls and measures.
          However, there are some advantages that midPoint can provide.
          Application inventory can be used to catalog third-party (cloud) services used by the organization.
          Classifications can be used to categorize the services, according to demonstrated certifications applicable to the services.
          Policy rules can be used to limit access to services with insufficient security levels or certifications.


- id: '5.22'
  title: 'Monitoring, review and change management of supplier services'
  category: organizational
  control: 'The organization should regularly monitor, review, evaluate and manage change in supplier information security practices and service delivery.'
  comment: 'Monitor updates to cloud applications, product updates'
  necessity: marginal
  related: [ '5.19', '5.20', '5.21', '5.29', '5.30', '5.35', '5.36', '8.14' ]
  relatedFrameworks: [ 'ISO27036-3' ]
  features: [ 'application-inventory', 'information-classification', 'policy-rule' ]
  implementation:
      overview: >
          MidPoint can provide some monitoring and inventory capabilities for applications.
      details: >
          This controls deals mostly with organizational procedures, not so much with technical controls and measures.
          However, there are some advantages that midPoint can provide.
          Application inventory can be used to catalog third-party (cloud) services used by the organization, which can be used as a basis for regular review, e.g. review of classifications.
          MidPoint can monitor some activity of users on the applications.
          E.g. midPoint can detect an application that was used recently, or application that is used only by a fraction of users that have access to it.


- id: '5.23'
  title: 'Information security for use of cloud services'
  category: organizational
  control: 'Processes for acquisition, use, management and exit from cloud services should be established in accordance with the organization’s information security requirements.'
  comment: 'acquisition, use, management and exit from cloud services, collaborative effort'
  necessity: optional
  related: [ '5.21', '5.22' ]
  relatedFrameworks: [ 'ISO17788', 'ISO17789', 'ISO19086', 'ISO19941', 'ISO22123-1', 'ISO27017', 'ISO27018', 'ISO27036-4' ]
  features: [ 'identity-lifecycle', 'connid-framework', 'provisioning', 'pdrbac', 'application-inventory', 'entitlement', 'information-classification' ]
  implementation:
      overview: >
          MidPoint can automatically manage access to cloud services.
      details: >
          This control deals mostly with contractual arrangements with cloud service providers, it is not focused on technical measures.
          However, midPoint plays an important role in managing cloud services at large.
          MidPoint is designed to manage access control to cloud services, creating accounts, assigning accounts to groups, granting and revoking privileges.
          Application inventory capability can be used to catalog cloud services in the first place, enabling classification of cloud services based on level of security or sensitivity of processes information.
          MidPoint can quickly provision access to a new application in case that an existing cloud application is disrupted or replaced,
          which is a natural part of exit strategy for almost every cloud application.



- id: '5.24'
  title: 'Information security incident management planning and preparation'
  category: organizational
  control: 'The organization should plan and prepare for managing information security incidents by defining, establishing and communicating information security incident management processes, roles and responsibilities.'
  comment: 'information security incident management processes'
  necessity: optional
  related: [ '5.5', '5.6', '5.25', '5.26', '5.28', '6.8', '8.15', '8.16' ]
  relatedFrameworks: [ 'ISO27035' ]
  features: [ 'reporting', 'schema-activation', 'simulation', 'pdrbac' ]
  implementation:
      overview: >
          MidPoint can provide useful information for preparation of incident management plans.
          MidPoint roles can be used to pre-configure emergency access control which can be used during incident response.
      details: >
          Reporting capability of midPoint can be used to provide information necessary for incident response,
          e.g. it can provide information about magnitude of user population that can be effected by certain incident types.
          Simulation capability can be used to predict effects of identity-based incidents, e.g. predict the effect of attacker gaining a particular role in the system.
          MidPoint policy-based RBAC mechanism can be used to pre-configure emergency access privileges for incident responders.
          Such privileges are not active during normal operation, yet they can be easily activated during incident response or emergency.
      notes:
          - >
              Emergency privileges for incident responders are configured in a form of conditional inducements in the usual (business) roles for incident responders.
              The condition evaluates to `false` during normal operation, can be quickly changed to `true` for incident response, which grants the privileges.
              The privileges can be easily removed when incident is handled.
      rationale: >
          Reporting and simulation can provide essential information for planning.
          Ability to pre-configure emergency access control can provide important advantage for rapid incident response.


- id: '5.25'
  title: 'Assessment and decision on information security events'
  category: organizational
  control: 'The organization should assess information security events and decide if they are to be categorized as information security incidents.'
  comment: 'classification of events as incidents'
  necessity: marginal
  related: [ '5.24', '5.26'  ]
  relatedFrameworks: [ 'ISO27035' ]
  features: [ 'identity-lifecycle', 'projection-link', 'schema-activation', 'application-inventory', 'information-classification' ]
  implementation:
      overview: >
          MidPoint can provide supplementary information for security event classification.
      details: >
          MidPoint can provide supplementary information for classification of security events.
          E.g. midPoint can provide information whether a user with compromised credentials had access to any systems, or whether the user was inactive.
          Application inventory can provide overview whether any users had access to vulnerable applications, and it can also provide hints whether vulnerable application was used at all.


- id: '5.26'
  title: 'Response to information security incidents'
  category: organizational
  control: 'Information security incidents should be responded to in accordance with the documented procedures.'
  comment: 'incident response, part of incident handling'
  necessity: optional
  related: [ '5.24', '5.25', '5.27', '5.28', '5.29', '5.30' ]
  relatedFrameworks: [ 'ISO27035' ]
  features: [ 'schema-activation', 'audit-trail', 'connid-framework', 'synchronization', 'reporting', 'dashboard', 'assignment-metadata' ]
  implementation:
      overview: >
          MidPoint provides essential information for incident response, as well as rapid immediate actions to contain the incident and ensure business continuity.
      details: >
          MidPoint is an essential tool for containing security incidents, allowing immediate deactivation of user access to applications.
          Assignment metadata can be used to provide information about privilege provenance, e.g. when the privilege was assigned, who has approved.
          This is an essential information for incident response, as it may point to affected or compromised identities, provide clues for investigation.
          MidPoint can help with evidence collection, especially by providing information on user access rights and records from its audit trail.
          Reporting and dashboard capabilities can provide important insights as well, both in containing phase and during evidence collection.
          MidPoint can be a useful tool in escalation phase as well, quickly providing temporary access to ensure business continuity.
          All escalation activities performed by midPoint are properly recorded in midPoint audit trail.

          In case that escalation activities are performed outside of midPoint control, midPoint can be used ex-post to clean up the escalation fallout, discovering temporary accounts and privilege escalation.
          Synchronization capabilities can be used for that purpose.
          Automated identity connectors based on ConnId framework ensure a quick response in the containment phase, as well as rapid escalation and reliable post-incident cleanup.
      notes:
          - >
              Information in assignment metadata can be accessed and interpreted quickly (as opposed to complex audit trail data), which provides significant benefit when rapid incident containment is necessary.
# TODO: move ex-post processing to other controls?
# TODO: necessary?


- id: '5.27'
  title: 'Learning from information security incidents'
  category: organizational
  control: 'Knowledge gained from information security incidents should be used to strengthen and improve the information security controls.'
  comment: 'ex-post incident processing, part of incident handling'
  necessity: optional
  related: [ '5.24', '5.25', '5.26', '5.28', '5.29', '5.30' ]
  features: [ 'audit-trail', 'simulation', 'reporting', 'assignment-metadata', 'synchronization' ]
  implementation:
      overview: >
          MidPoint can provide essential information for ex-post investigation and processing of incidents, covering both the actions of attackers and responders.
      details: >
          MidPoint records all operations in audit trail, including actions of the attackers and responders.
          This information can be used to learn about the incident, as well as evaluate the steps taken to respond to incident.
          Reporting capabilities and assignment metadata can provide essential information about affected identities, as well as provide insights and estimates about vulnerable identities that could be affected in similar incidents in the future.
          Synchronization capability can be used to discover discrepancies between the policy and reality,
          discovering illegal accounts and privileges that were either created by attacker, or that are leftovers from incident response.
          Such information provides important insights to the modus operandi of an attacker, and it manifests flaws in response plans (e.g. missing clean-up instructions).
          Simulation capability can be used to preview the effects of changes that an attacker would make, estimating their effects on access control.
          Simulation can also be used to predict and validate proposed changes to policies, to reflect the post-incident knowledge.
# TODO: necessary?
# TODO: recommendations full sync

- id: '5.28'
  title: 'Collection of evidence'
  category: organizational
  control: 'The organization should establish and implement procedures for the identification, collection, acquisition and preservation of evidence related to information security events.'
  comment: 'collecting data, maintain chain of custody'
  necessity: optional
  related: [ '5.24', '5.25', '5.26', '5.27', '5.29', '5.30' ]
  features: [ 'audit-trail', 'reporting', 'object-metadata', 'assignment-metadata', 'value-metadata', 'synchronization', 'sod' ]
  implementation:
      overview: >
          MidPoint is one of important sources of evidence for incident investigation.
          Additionally, midPoint access control capabilities can be used to preserve evidence.
      details: >
          MidPoint is essential system for identity administration and governance, which makes it one of the most important sources of evidence.
          Reporting capabilities can be used to provide current information, while audit trail and meta-data can provide insights into past state of information before the incident, and changes occurred during the incident.
          Synchronization capability can be used to discover discrepancies between the policy and reality,
          discovering illegal accounts and privileges that were either created by attacker, or that are leftovers from incident response.
          Access control mechanisms, especially the segregation of duties (SoD) mechanism, can be used to assist in evidence preservation.
          E.g. the SoD mechanism can be used to limit possibilities of "history rewriting" by modification of midPoint audit trail, by excluding database administration and midPoint administration roles,
          ensuring that no single person has full control over content of audit trail.
# TODO: recommendations regarding audit trail (insert-only) and log server, full sync

- id: '5.29'
  title: 'Information security during disruption'
  category: organizational
  control: 'The organization should plan how to maintain information security at an appropriate level during disruption.'
  comment: 'be secure during disruption'
  necessity: optional
  related: [ '5.24', '5.25', '5.26', '5.27', '5.28', '5.30' ]
  relatedFrameworks: [ 'ISO22301', 'ISO22313', 'ISO22317' ]
  features: [ 'pdrbac', 'policy-rule', 'information-classification', 'sod', 'synchronization', 'synchronization-reaction', 'provisioning', 'provisioning-consistency', 'object-mark', 'audit-trail' ]
  implementation:
      overview: >
          MidPoint maintains all policies and rules during incident response.
          Pre-configure emergency access control can be used during incident response.
          Synchronization can be used to restore security after disruption.
      details: >
          Policy-driven RBAC mechanism can be used to activate pre-configure emergency access control during disruption, providing controlled and panic-free elevation of privileges for incident responders.
          Segregation of duties, information classification and other policy rules are still applied during disruption (e.g. incident), hindering attempts to create major access control breach by the attacker or the responders.
          Synchronization capability can be explicitly invoked during of after the disruption to make sure access control rules are still properly applied.
          Synchronization can discover illegal accounts and privileges that were either created by attacker, or that are leftovers from incident response.
          Any illegal access can be automatically de-provisioned (deactivated) using synchronization reactions.
          Provisioning consistency capability of midPoint automatically corrects all inconsistencies it discovers, including policy violations.
          Object marks can be used to mark suspicious accounts and roles during disruption for closer investigation at later date.
          Should there be a need to create a replacement system during disruption,
          midPoint RBAC mechanisms together with efficient provisioning engine can be used to quickly and automatically grant access to the replacement system,
          maintaining appropriate access levels for individual users.
          MidPoint audit trail records all changes that were made during disruption using midPoint, or that were discovered by midPoint.
          This information can be used to restore the appropriate level of security after disruption.

- id: '5.30'
  title: 'ICT readiness for business continuity'
  category: organizational
  control: 'ICT readiness should be planned, implemented, maintained and tested based on business continuity objectives and ICT continuity requirements.'
  comment: 'be available during disruption, business continuity, business impact analysis (BIA)'
  necessity: optional
  related: [ '5.24', '5.25', '5.26', '5.27', '5.28', '5.29' ]
  relatedFrameworks: [ 'ISO27031', 'ISO22301', 'ISO22313', 'ISO22317' ]
  features: [ 'ha', 'auto-scaling', 'identity-repository', 'provisioning', 'synchronization', 'provisioning-consistency', 'pdrbac' ]
  implementation:
      overview: >
          MidPoint can be used to quickly prepare replacement system in case of disruption.
          Pre-configure emergency access control can be used during incident response.
      details: >
          MidPoint is designed to work with systems (identity resources) that are not constantly available.
          Operations are re-tried, resource can be explicitly configured for maintenance mode, synchronization capability can be used to restore data consistency.
          Provisioning consistency capability of midPoint automatically corrects all inconsistencies it discovers, which can be used to gradually recover from disruption.
          Auto-scaling capability can provide resilience to unexpected load peaks.
          Should there be a need to create a replacement system during disruption,
          midPoint RBAC mechanisms together with efficient provisioning engine can be used to quickly and automatically grant access to the replacement system,
          maintaining appropriate access levels for individual users.
          E.g. midPoint can quickly provision access to a new application in case that an existing cloud application is disrupted.
          MidPoint identity repository contains copies of identity data, which can be used to quickly restore the data to any application.
          Policy-driven RBAC mechanism can be used to activate pre-configure emergency access control during disruption, providing controlled and panic-free elevation of privileges for incident responders.
      notes:
          - >
              MidPoint has a built-in high-availability features.
          - >
              Unavailability of MidPoint does not mean unavailability of identity and access management capabilities.
              MidPoint is designed to provision changes to identity resources, allowing resources to operate independently.
              Unavailability of midPoint means limitation of identity management capabilities, however it does not usually limit operational capabilities of applications.

# Example: identifying users affected by a breach of all passwords on particular application, forcing them to change password.

- id: '5.31'
  title: 'Legal, statutory, regulatory and contractual requirements'
  category: organizational
  control: 'Legal, statutory, regulatory and contractual requirements relevant to information security and the organization’s approach to meet these requirements should be identified, documented and kept up to date.'
  comment:
  necessity: optional
  related: [ '5.1', '5.2', '5.12', '5.13', '5.14', '5.19', '5.20', '5.21', '5.22', '5.32' ]
  features: [ 'documentation', 'integral-documentation', 'information-classification', 'access-certification', 'role-certification', 'org', 'policy-rule', 'risk-management' ]
  implementation:
      overview: >
          MidPoint documentation provides overview and guidance for compliance with several compliance frameworks.
          Integral documentation of midPoint can be used to document fulfillment of specific compliance requirements.
      details: >
          MidPoint documentation has a special compliance section, which provides overview and guidance for compliance with several compliance frameworks.
          Integral documentation of midPoint (a.k.a. midScribe) can be used to maintain deployment documentation together with the configuration,
          with an ability to automatically generate comprehensive deployment documentation.
          This approach is ideal for documentation of fulfillment of specific compliance requirements, together with the technical means used to implement them.
          The documentation can be easily kept up to date, and the configuration can easily be reviewed when compliance requirements change.
          Certification mechanisms can be used to regularly review applicability of policies (e.g. roles) to satisfy compliance requirements.
          Certification can also be used to automatically review assignment of information classifications (labeling) and clearances.
          Access certification is also useful for regular review of security-related roles and responsibilities.
          Organizational structure and location hierarchies can be used to apply variations of policies to specific organizational units or locations, reflecting specifics of local legislation and regulations.
          Policy rules can be used to limit transfer of information (e.g. personal data) to regions limited by regulations, or regions that do not provide appropriate protection for information.
          Risk management capabilities (planned) could be used to identify risk hot-spots, prioritizing them for risk treatment and improvements of related policies.

- id: '5.32'
  title: 'Intellectual property rights'
  category: organizational
  control: 'The organization should implement appropriate procedures to protect intellectual property rights.'
  comment:
  necessity: optional
  related: [ '5.31' ]
  relatedFrameworks: [ 'ISO19770', 'ISO23751' ]
  features: [ 'license-management', 'reporting', 'dashboard', 'object-metadata', 'value-metadata', 'application-inventory' ]
  implementation:
      overview: >
          MidPoint can provide data essential for management of licenses and other intellectual property rights.
      details: >
          Reporting capability can be used to provide data about number of active users in each system, which is essential information for management of licenses.
          Dashboards can be set up to continually monitor this information.
          Meta-data provide information about origins of data, which may also be useful for license management purposes.
          Application inventory can be used as an asset register, enriched with intellectual property information for each application.
          Planned license management feature will provide automated controls over license use, utilization and limitations.

- id: '5.33'
  title: 'Protection of records'
  category: organizational
  control: 'Records should be protected from loss, destruction, falsification, unauthorized access and unauthorized release.'
  comment: 'chain of custody, archival, data warehousing'
  necessity: optional
  related: [ '5.34' ]
  relatedFrameworks: [ 'ISO15489', 'GDPR' ]
  features: [ 'object-lifecycle', 'audit-trail', 'midpoint-object-language', 'object-metadata', 'value-metadata', 'information-classification', 'application-inventory', 'identity-repository', 'representation-xml', 'representation-json', 'representation-yaml', 'authorization' ]
  implementation:
      overview: >
          MidPoint has several mechanisms to ensure long-term retention of essential information.
      details: >
          MidPoint can apply lifecycle models to all object types, including identities, policy and configuration objects.
          There is a built-in "archived" lifecycle state, which is supposed to mark objects stored for record-keeping purposes.
          Objects can be kept around in archived state as long as the legislation requires, e.g. as required by regulations regarding retention of employee data.
          Archived objects can be used to avoid re-use of identifiers, avoiding inconsistencies in long-term record-keeping.
          MidPoint records all activities in audit trail, which can be further processed and archived as permanent record.
          Data structure of the audit trail is publicly documented, using data formats that are very likely to remain readable in the future.
          MidPoint object language assists in long-term storage of objects, as the language is text-based (XML,JSON,YAML), clearly defined by schema and version controlled.
          Objects stored in midPoint object language are guaranteed to be readable and machine-processable in the foreseeable future.
          Authorizations can be used to limit access to information stored in midPoint repository, making sure that records have appropriate level of protection.
          E.g. special access control rules can be applied to archived data objects.
      notes:
          - >
              While audit trail provides detailed record of all activities, it is also quite demanding to store full audit trail for a long time.
              Retention of audit log data may be limited by other factors too, such as privacy regulations.
              Therefore, audit trails are frequently kept only for a limited time periods.
              However, midPoint meta-data can be used as a partial supplement for audit trail data, as the metadata record important moments of data lifetime.
              Metadata can be maintained for a very long period of time, providing essential record-keeping information even if detailed audit trail data are lost.
          - >
              Information classification should be considered for retention of records.
              Application inventory, and especially the classification of applications can provide baseline data for setting up retention of information in individual systems.
              E.g. setting up policies to report inactive accounts in systems with respect to their classification, or setting up certification policies with am iam to remove unnecessary accounts.


- id: '5.34'
  title: 'Privacy and protection of PII'
  category: organizational
  control: 'The organization should identify and meet the requirements regarding the preservation of privacy and protection of PII according to applicable laws and regulations and contractual requirements.'
  comment: ''
  necessity: necessary
  related: [ '5.12', '5.14', '5.33' ]
  relatedFrameworks: [ 'ISO29100', 'ISO27018', 'ISO27701', 'ISO29314', 'GDPR' ]
  features: [ 'common-identity-model', 'object-lifecycle', 'projection-link', 'provisioning', 'synchronization', 'rbac', 'integral-documentation', 'object-metadata', 'value-metadata', 'assignment', 'information-classification', 'policy-rule', 'authorization', 'audit-trail' ]
  environment: >
      ISO27002 guidance for this control is surprisingly brief, given the scope, depth and impact of privacy to cybersecurity field.
      The guidance refers to other ISO documents, and especially to relevant legislation and regulations.
      General data protection regulation (GDPR) enacted by European Union is a prime example of such legislation.
      It sets requirements, expectations and best practices that are worth following even in international context.
  implementation:
      overview: >
          MidPoint provides features that are necessary for maintaining privacy at scale, especially when dealing with consumer identities, external collaborators and similar broad user communities.
      details: >
          MidPoint is built specifically to work with personal data, keep the data consistent, control transfer of personal data and enforce policies.
          As such, it has absolutely crucial role in establishing and maintaining of privacy practices in organizations, especially if the privacy is to be applied consistently at scale.
          The core of the functionality is formed around common identity model (common schema) that midPoint brings for identities.
          Common identity model gives meaning to all the identity data, allowing establishment of policies on their appropriate use.
          For example we know which attributes contain personally identifiable information (PII), therefore we can control its distribution and use.
          This is further refined by identity lifecycle mechanism, controlling use and storage of data at certain states of identity lifecycle.
          For example, data regarding archived identities can be automatically reduced to the necessary minimum (information erasure).
          Projection links are used in midPoint to track copies of information, which is essential for keeping records about copies of personal data.
          The links are efficiently creating information inventory for personal data.
          Provisioning mechanism can be used to set up appropriate extent of personal data to target systems.
          Even more importantly, it can also be used to delete (deprovision) the data when not needed.
          Provisioning, together with synchronization mechanisms are essential for keeping all copies of personal data up-to-date, which is a common requirement of privacy regulations.
          Assignments can be used to track application of legal bases for information processing, represented by roles and services (applications).
          Assignment can also be used as a reflection of user consent, making sure that all information provisioned at the time consent was given is properly deprovisioned when consent is revoked.
          Integral documentation (midScribe) can be used to document the legal bases for information processing as they are associated with roles and services.
          This is especially useful for documenting business roles and archetypes, as they usually convey information about legal bases (e.g. employee archetype as representation of employment contract as a legal basis).
          Object metadata can be used to record origin of objects, documenting legal provenance of processed information.
          This can be further extended by value metadata, which document provenance of every individual data item and value.
          Use of location information and classifications, together with policy rules, can be used to avoid illegal transfer of personal information, e.g. making sure that personal information is copied only to applications located in European Union.
          Authorizations can be used to limit access to personal information within midPoint, controlling access at very fine level.
          Audit trail is used to record all activities regarding use and copies of personal information within the reach of midPoint deployment.
      rationale: >
          While privacy and personal data can be managed manually in smaller organizations, midPoint is absolutely essential for large organizations.
          The minute details of personal data management cannot be easily tracked and managed when number of identities, identity types, roles and policies grows.
          Automation and policy-based approach is the only feasible option.
      notes:
          - >
              Retention of audit log data may be limited by privacy regulations.
          - >
              Very common misconception is that privacy is all about secrecy of personally identifiable information (PII).
              This belief is wrong in all of its aspects.
              Firstly, privacy is not just about secrecy of information.
              Privacy is primarily concerned about appropriate use of information.
              The sole fact that an organization legally posses personal data does not entitle the organization to unlimited processing of the data.
              Secondly, privacy is not just about personally identifiable information, such as national identifiers.
              Privacy is concerned with much broader concept of personal data, which includes information that may not be necessarily identifiable, such as information about gender or medical condition of subjects.
              Overall, understanding the nature of privacy is much more complex than it may seem.
              Consultation with a privacy professional is more than recommended.
# Privacy officer (also in GDPR)

- id: '5.35'
  title: 'Independent review of information security'
  category: organizational
  control: 'The organization’s approach to managing information security and its implementation including people, processes and technologies should be reviewed independently at planned intervals, or when significant changes occur.'
  comment: 'audits'
  necessity: not-applicable
  related: [ '5.1' ]
  implementation:
      rationale: >
          This is purely organizational control, dealing with organization of independent reviews and audits.
          The control is concerned with legislation, processes and policies on a level far above the technical measures provided by midPoint.

- id: '5.36'
  title: 'Compliance with policies, rules and standards for information security'
  category: organizational
  control: 'Compliance with the organization’s information security policy, topic-specific policies, rules and standards should be regularly reviewed.'
  comment: 'compliance reviews and corrective actions'
  necessity: necessary
  related: [ '5.35', '8.15', '8.16', '8.17' ]
  relatedFrameworks:
  features: [ 'reporting', 'dashboard', 'role-governance', 'policy-rule', 'object-mark', 'access-certification', 'role-certification', 'application-inventory', 'integral-documentation', 'simulation' ]
  implementation:
      overview: >
          MidPoint provides many essential capabilities for verifying, reviewing and demonstrating compliance, as well as implementation of corrective actions.
      details: >
          MidPoint is designed to automatically enforce compliance with policies defined in forms of roles and policy rules.
          Policies that are not automatically enforces can be analyzed, and violations of the policies can be reported and/or displayed using dashboards.
          Objects that do not conform to the policies can be automatically or manually marked (using object marks) and manually reviewed.
          Integral documentation can be used to document policies, as well as exceptions and special cases.
          Role governance capabilities can be used to track role, application and information owners and other responsible person, distributing review effort to a broader team.
          Policy rules can be set up to make sure every application and role has an appropriate governance structure (e.g. it has an active owner).
          Certification campaigns can be used to review applicability of policies, especially applicability and adequacy of role definitions.
          Simulation capabilities can be used to verify that new corrective actions can be effective.
      notes:
          - >
              The control asks for use of "automatic measurement and reporting tools".
              MidPoint is an ideal tool for automatic measurement and reporting of information regarding identities and access control.


- id: '5.37'
  title: 'Documented operating procedures'
  category: organizational
  control: 'Operating procedures for information processing facilities should be documented and made available to personnel who need them.'
  comment: ''
  necessity: optional
  related: [ '7.10', '7.14', '8.13', '8.18'  ]
  relatedFrameworks:
  features: [ 'common-identity-model', 'integral-documentation', 'org', 'role-governance', 'audit-trail' ]
  implementation:
      overview: >
          MidPoint has built-in documentation capabilities that assist in documenting operation procedures and responsibilities.
      details: >
          MidPoint identity model provides capability to set business-oriented description for any object.
          This is especially useful for applications, application and business roles and other objects related to operational procedures.
          The description may be used to specify details about business and operational usage of the object.
          Moreover, midPoint integral documentation (midScribe) allows attaching configuration documentation to midPoint objects, assisting in system administration procedures.
          Support and escalation contacts in operational procedures may be specified using group or organizational membership, using midPoint organizational structure.
          This avoids a need to update operational procedures every time a person is reassigned.
          Roles and responsibilities regarding identity governance procedures can be specified using role governance mechanisms, e.g. using concept of role owner in operational procedures instead of using concrete person names.
      notes:
          - >
              The control mentions access to audit trail and system log information.
              Both mechanisms are available in midPoint.

- id: '6.1'
  title: 'Screening'
  category: people
  control: 'Background verification checks on all candidates to become personnel should be carried out prior to joining the organization and on an ongoing basis taking into consideration applicable laws, regulations and ethics and be proportional to the business requirements, the classification of the information to be accessed and the perceived risks.'
  comment: ''
  necessity: optional
  related: [ '5.12', '5.13' ]
  relatedFrameworks:
  features: [ 'identity-lifecycle', 'information-classification', 'rbac', 'pdrbac', 'policy-rule', 'access-certification', 'micro-certification', 'org', 'reporting' ]
  implementation:
      overview: >
          Capabilities to manage identity lifecycle, clearances and enforce policy rules are instrumental in enforcing effects of personnel screening by midPoint.
      details: >
          Identity lifecycle capabilities can be used to make sure privileges are not assigned to users before all initial screening procedures are completed.
          E.g. lifecycle status "proposed" can be used to represent a person who has active contract but have not passed necessary screening yet.
          MidPoint clearances (part of information classification features) can be used to represent results of additional personnel screening.
          Policy rules can be used to enforce polices with respect to screening, e.g. enforcing that only users that have passed the screening can get access to applications containing sensitive information.
          Role-based access control structures can be set up to require screening for certain roles or jobs, especially for security-related tasks.
          Certification campaign can be used to repeat or update screening as necessary.
          Micro-certifications can be used to initiate ad-hoc screening when a person is reassigned in organizational structure or acquires a role with elevated privileges.
          Reporting capabilities ca provide visibility, e.g. reporting personnel that have passed screening, or personnel that were the screening was not updated in a long time.

- id: '6.2'
  title: 'Terms and conditions of employment'
  category: people
  control: 'The employment contractual agreements should state the personnel’s and the organization’s responsibilities for information security.'
  comment: ''
  necessity: not-applicable
  related: [ '5.9', '5.10', '5.11', '5.12', '5.13', '5.32', '5.34', '6.4', '6.6' ]
  relatedFrameworks:
  implementation:
      rationale: >
          This control is limited to contractual obligations, it does not affect technical means.

- id: '6.3'
  title: 'Information security awareness, education and training'
  category: people
  control: "Personnel of the organization and relevant interested parties should receive appropriate information security awareness, education and training and regular updates of the organization's information security policy, topic-specific policies and procedures, as relevant for their job function."
  comment: ''
  necessity: optional
  related: [ '5.1', '5.12', '5.13' ]
  relatedFrameworks:
  features: [ 'information-classification', 'rbac', 'pdrbac', 'policy-rule', 'provisioning', 'access-certification', 'micro-certification', 'reporting' ]
  implementation:
      overview: >
          MidPoint capabilities provide convenient support for security trainings, re-trainings, enforcing access policies and spreading of cybersecurity awareness.
      details: >
          MidPoint clearances (part of information classification features) can be used to represent security training necessary to get elevated privileges or access to sensitive information.
          Policy rules can be used to enforce the policy, not allowing access to any user that have not passed necessary training.
          Certification campaigns can be used to update the trainings, listing people that need to be re-training and track progress of re-training.
          Micro-certifications can be used to initiate ad-hoc re-training when a person is reassigned in organizational structure or acquires a role with elevated privileges.
          Provisioning capabilities can be combined with role-based access control to set up special-purpose e-mail distribution lists to manage security awareness.
          For example, a special-purpose e-mail distribution list can be set up for all personnel related to cybersecurity.
          All business roles that relate to cybersecurity may induce membership in the list, thus the list is automatically managed.
          Such list can be used to spread awareness about updated policies, potential vulnerabilities, training opportunities, suggestions of best practice, infographics and so on.
          Information distributed using automatically-managed lists is can be targeted, adapted to a specific audience and hence much more effective.
          Similar lists can be automatically set up for all users dealing with sensitive information (using information classifications), all personnel dealing with personal data and so on.
          Additionally, reporting can be used to select candidates for re-training, or persons that need to be informed about policy changes.


- id: '6.4'
  title: 'Disciplinary process'
  category: people
  control: 'A disciplinary process should be formalized and communicated to take actions against personnel and other relevant interested parties who have committed an information security policy violation.'
  comment: ''
  necessity: optional
  related: [ '5.15', '5.18', '5.28' ]
  relatedFrameworks:
  features: [ 'rbac', 'assignment', 'schema-activation', 'identity-lifecycle'  ]
  implementation:
      overview: >
          MidPoint can be used as a tool to easily reduce access rights of users that violate the policy.
      details: >
          In midPoint, access is granted to users using assignments, usually role assignments.
          The assignment contains an activation part, which can be used to control validity of the assignment.
          For disciplinary actions, assignment activation can be used to temporarily disable the assignment, revoking access rights from user that violated the policies.
          The assignment stays in place, therefore the access can be easily restored for the user when the disciplinary action is over.
          Moreover, the activation mechanism allow to set up revocation of access rights for a specific period, after which access rights are automatically restored.
          In extreme cases, identity lifecycle can be used to temporarily disable all access of specific user, using the "suspended" lifecycle state.

- id: '6.5'
  title: 'Responsibilities after termination or change of employment'
  category: people
  control: 'Information security responsibilities and duties that remain valid after termination or change of employment should be defined, enforced and communicated to relevant personnel and other interested parties.'
  comment: 'privileges after termination and re-org'
  necessity: optional
  related: [ '5.2', '6.2', '6.6' ]
  relatedFrameworks:
  features: [ 'pdrbac', 'org', 'inducement', 'role-autoassignment', 'identity-lifecycle', 'synchronization', 'reporting', 'object-history', 'audit-trail', 'micro-certification', 'policy-rule', 'delegated-administration', 'notification', 'information-classification'  ]
  implementation:
      overview: >
          Identity lifecycle and policy-driven role-based access control (PD-RBAC) mechanism are instrumental in handling privileges in termination/change situations.
      details: >
          Identity lifecycle can naturally handle termination of employment.
          MidPoint is using synchronization mechanisms to pull data from the human resource (HR) systems, including data about termination and change of employment.
          Such HR data are reflected to identity lifecycle, usually setting users with terminated employment to archived lifecycle state.
          This lifecycle state can be used to deactivate any access that user had, it can be used to minimize the data or handle the situation in other ways.
          Assignments can be retained in archived lifecycle state, indicating roles, organizational membership and responsibilities that the user had at the termination of employment.
          This can be an advantage for clearances that indicate responsibilities and obligations that remain valid after termination of employment, such as non-disclosure agreements (NDA).
          Policy-driven role-based access control (PD-RBAC) is designed to automatically react to change of employment.
          The preferred method to grant privileges based on organizational structure is to use inducement mechanism in organizational units.
          Privileges granted using such mechanisms are automatically recomputed when employment changes, as indicated by change in organizational structure synchronized from the HR system.
          Alternatively, role auto-assignment rules can be used to automatically adjust privileges when employment and responsibilities of user changes.
          Micro-certification can be used as an supplementary mechanisms, especially in case that most privileges are assigned using access request process.
          Micro-certification can be automatically triggered when user's organizational assignment changes, motivating reduction of privileges.
          Policy rules can be used together with reporting capabilities to detect vacant roles and responsibilities, e.i. responsibilities that need to re-assigned after termination or change of employment of their (former) assignees.
          Delegated administration can enable suppliers and partner to manage identities representing their organizations, e.g. de-activating access after termination of employment.
          Audit trail and object history capabilities can be used to examine privileges that a user had before termination or change of employment, e.g. to improve current policies and automation schemes.
      rationale: >
          MidPoint obviously cannot influence contractual obligations after termination of employment or contract.
          It can keep user record for some time, even record some of the obligations.
          However, the primary strength of midPoint is handling situations after "change of employment", which usually means re-assignment of users in organizational structure.
          Many mechanisms of midPoint can be used in this situation.
      notes:
          - >
              The control suggests that changes in responsibility should be managed as termination of old responsibility and initiation of new responsibility.
              We like to interpret that in quite a loose way, not requiring literal termination of accounts or removal of privileges that are necessary for new responsibility.
              MidPoint is designed to remove accounts and privileges that are not needed for new responsibility, keeping the necessary ones.

- id: '6.6'
  title: 'Confidentiality or non-disclosure agreements'
  category: people
  control: 'Confidentiality or non-disclosure agreements reflecting the organization’s needs for the protection of information should be identified, documented, regularly reviewed and signed by personnel and other relevant interested parties.'
  comment: ''
  necessity: optional
  related: [ '5.12', '5.13', '5.31', '5.32', '5.33', '5.34' ]
  relatedFrameworks:
  features: [ 'information-classification', 'policy-rule', 'rbac', 'inducement', 'archetype', 'reporting', 'audit-trail', 'assignment-metadata' ]
  implementation:
      overview: >
          Information classification and clearance mechanism can be used to enforce presence of appropriate agreements.
      details: >
          Clearances can be used to represent appropriate confidentiality and non-disclosure agreements (NDA).
          Policy rules can be used to limit access to sensitive applications in such a way that a valid NDA is required to grant access to them.
          Reporting capabilities can be used to analyze and review state of the agreements granted as clearances.
          Audit trail and assignment meta-data can be used to review history of assignment of clearances.
      rationale: >
          MidPoint cannot handle the contractual details of confidentiality and non-disclosure agreements, as required by the control.
          However, midPoint can enforce presence of appropriate agreement before access is granted to information that requires it.
      notes:
          - >
              Inducements in archetype can be used to denote implied clearances.
              E.g. all employees have implicit NDA clearance, as they have non-disclosure clause in their employment contracts.
              This can be modeled by inducing the NDA clearance in employee archetype.

- id: '6.7'
  title: 'Remote working'
  category: people
  control: 'Security measures should be implemented when personnel are working remotely to protect information accessed, processed or stored outside the organization’s premises.'
  comment: ''
  necessity: optional
  related: [ '5.3', '5.11', '5.12', '5.13', '6.5', '6.8' ]
  relatedFrameworks:
  features: [ 'rbac', 'provisioning', 'entitlement', 'information-classification', 'policy-rule', 'identity-lifecycle', 'reporting' ]
  implementation:
      overview: >
          MidPoint has mechanisms to set up access for remote work, and automatically de-provision it when not needed.
      details: >
          Role-based access control (RBAC) mechanism together with provisioning can be used to set up all necessary privileges and security configuration for remote access.
          This includes configuration of network access through firewalls, virtual private networks (VPNs), authentication configuration, policies and so on.
          RBAC, provisioning and identity lifecycle can make sure that the access is properly disabled (de-provisioned) when remote access is no longer needed or employment is terminated, making sure that the network access will not be left open.
          Provisioning configuration and policy rules can be used to make sure that the users with remote access have appropriate configuration to use multi-factor authentication.
          Reporting capability can be used to find users that have remote access, yet they do not have appropriate credentials for second factor enrolled yet.
          Information classification together with policy rules can make sure that users with remote access do not have access to systems containing highly-sensitive information, if such policy is necessary.
      rationale: >
          This control deals mostly with policies and physical security measures for remote working locations.
          However, midPoint can help with policies and access control, especially network access control (firewalls, VPNs) and configuration.
          MidPoint is essential tool to make sure the access is automatically de-provisioned, making sure that the network access will not be left open when no longer needed.
      notes:
          - >
              Denying access of users with remote working permissions to sensitive systems is implemented by mechanism that is functionally equivalent to segregation of duties (SoD).
#  TODO: password management/policy?

- id: '6.8'
  title: 'Information security event reporting'
  category: people
  control: 'The organization should provide a mechanism for personnel to report observed or suspected information security events through appropriate channels in a timely manner.'
  comment: ''
  necessity: marginal
  related: [ '5.24', '5.25', '5.26', '5.27', '5.28' ]
  relatedFrameworks:
  features: [ 'reporting', 'policy-rule', 'synchronization', 'orphaned-account-management', 'audit-trail' ]
  implementation:
      overview: >
          MidPoint provides features that can provide security event details if necessary.
      details: >
          MidPoint provides supporting capabilities, which provides data regarding security events, making reporting of the events easier.
          MidPoint reporting capabilities, audit trail as well as information produced by policy rules can be used to provide such information.
          Synchronization capability can automatically detect, report and handle some security events, such as orphaned accounts.
      rationale: >
          This control focuses on mechanisms allowing users to report security events.
          MidPoint has strong capabilities that support security event detection.
          However, such detection mechanisms are not focus of this control.
          Therefore midPoint can provide only marginal support for this control.


- id: '7.1'
  title: 'Physical security perimeters'
  category: physical
  control: 'Security perimeters should be defined and used to protect areas that contain information and other associated assets.'
  comment: ''
  necessity: marginal
  related: [ '5.15', '5.18', '7.2' ]
  relatedFrameworks:
  features: [ 'application-inventory', 'org', 'policy-rule', 'reporting' ]
  implementation:
      overview: >
          MidPoint can provide supportive role, recording perimeters for applications.
      details: >
          MidPoint organizational structure can be used to model the perimeters as locations.
          Applications can be assigned to the perimeters, enabling use of perimeters in access control policies.
          Policy rules can be used to set up some supportive policies, e.g. allowing access to some applications only if user has a physical access token for appropriate perimeter.
          Additionally, reporting capabilities can be used detect suspicious cases, e.g. application access granted to users that do not share a location with the application.
      rationale: >
          This control is all about physical security, which is out of reach of midPoint.
          However, midPoint can play a marginal supportive role by keeping list of security perimeters and their relationships to applications.
          Some policy rules might be applicable as well.


- id: '7.2'
  title: 'Physical entry'
  category: physical
  control: 'Secure areas should be protected by appropriate entry controls and access points.'
  comment: ''
  necessity: optional
  related: [ '5.9', '5.17', '5.18', '5.33', '7.1', '7.10' ]
  relatedFrameworks:
  features: [ 'identity-lifecycle', 'synchronization', 'provisioning', 'entitlement', 'org', 'rbac', 'policy-rule', 'access-certification', 'delegated-administration', 'self-registration', 'schema-activation' ]
  implementation:
      overview: >
          MidPoint can provide a degree of automation regarding management of physical access tokens, especially with respect to their revocation.
      details: >
          MidPoint can be integrated with system managing physical access tokens by using ordinary provisioning capabilities and identity connectors.
          In such case, midPoint can manage access tokens and their properties, controlling physical access privileges of persons using policies and automation.
          MidPoint can use location information to automatically grant basic access to physical location.
          Even more importantly, midPoint can automatically revoke all physical access to location when a person is re-assigned to a different location.
          MidPoint can use identity lifecycle mechanism to automatically revoke all physical access when employment is terminated, based on data synchronized from the human resource (HR) system.
          Role-based access control (RBAC) mechanism can be used to automatically grant and revoke physical access based on job roles and responsibility.
          E.g. midPoint can automatically grant physical access to call center rooms for all call center agents, automatically revoking the access when person is re-assigned to a different job.
          Policy rules can be used to limit access to certain areas only to specific roles or organizational units.
          E.g. access to information processing facilities (data centers, server rooms) can be limited only for IT staff, refusing to grant such access for any non-IT personel.
          Access certification mechanism can be used for re-certification of physical access (e.g. access to security perimeters).
          MidPoint delegated administration can be used to register visitors and automatically grant them physical access appropriate for the location.
          Alternatively, self-registration can be used by visitors to pre-register for access.
          Activation schema can be used to grant access to visitors on a temporary basis, automatically disabling all granted access after a specified time period.
      rationale: >
          This control is mostly about physical security, which is out of reach of midPoint.
          However, midPoint is very effective tool for managing physical access tokens, especially revocation of the tokens.


- id: '7.3'
  title: 'Securing offices, rooms and facilities'
  category: physical
  control: 'Physical security for offices, rooms and facilities should be designed and implemented.'
  comment: ''
  necessity: marginal
  related: [ '7.2' ]
  relatedFrameworks:
  features: [ 'provisioning', 'rbac', 'entitlement' ]
  implementation:
      overview: >
          MidPoint can control access privileges for directories.
      details: >
          MidPoint can control access privileges for directories, internal phonebooks and online accessible maps.
      rationale: >
          This control is all about physical security, which is out of reach of midPoint.
          However, midPoint can provide marginal support by controlling access to supplementary information.


- id: '7.4'
  title: 'Physical security monitoring'
  category: physical
  control: 'Premises should be continuously monitored for unauthorized physical access.'
  comment: 'surveillance'
  necessity: optional
  related: [ '5.26', '5.34' ]
  relatedFrameworks:
  features: [ 'provisioning', 'rbac', 'entitlement' ]
  implementation:
      overview: >
          MidPoint can control access to surveillance and alarm systems.
      details: >
          Provisioning capabilities of midPoint, together with role-based access control (RBAC) policies can be used to grant access to monitoring and alarms systems to appropriate personel.
          Even more importantly, the same mechanisms can be used to revoke the access when it is no longer appropriate.
          MidPoint policies can be used to make sure only minimal necessary set of people can access to video surveillance, minimizing privacy risks.
          E.g. midPoint can be set up in such a way that only a small surveillance staff has permanent access to video surveillance, granting temporary access to more people (incident responders, investigators) only in case of security event.
          Such access is automatically revoked when security event handling is finished.
      rationale: >
          This control is mostly about physical security, which is out of reach of midPoint.
          However, midPoint can provide access control capabilities for physical security, surveillance and alarm systems.


- id: '7.5'
  title: 'Protecting against physical and environmental threats'
  category: physical
  control: 'Protection against physical and environmental threats, such as natural disasters and other intentional or unintentional physical threats to infrastructure should be designed and implemented.'
  comment: ''
  necessity: not-applicable
  related:
  relatedFrameworks:
  implementation:
      rationale: >
          This control is concerned with physical security only, which is out of reach of midPoint.

- id: '7.6'
  title: 'Working in secure areas'
  category: physical
  control: 'Security measures for working in secure areas should be designed and implemented.'
  comment: ''
  necessity: not-applicable
  related:
  relatedFrameworks:
  implementation:
      rationale: >
          This control is concerned with physical security only, which is out of reach of midPoint.

- id: '7.7'
  title: 'Clear desk and clear screen'
  category: physical
  control: 'Clear desk rules for papers and removable storage media and clear screen rules for information processing facilities should be defined and appropriately enforced.'
  comment: ''
  necessity: not-applicable
  related:
  relatedFrameworks:
  implementation:
      rationale: >
          This control is concerned with physical security only, which is out of reach of midPoint.

- id: '7.8'
  title: 'Equipment siting and protection'
  category: physical
  control: 'Equipment should be sited securely and protected.'
  comment: ''
  necessity: not-applicable
  related:
  relatedFrameworks:
  implementation:
      rationale: >
          This control is concerned with physical security only, which is out of reach of midPoint.


- id: '7.9'
  title: 'Security of assets off-premises'
  category: physical
  control: 'Off-site assets should be protected.'
  comment: 'mobile devices, BYOD'
  necessity: optional
  related: [ '5.11', '5.14', '6.7', '7.4', '7.5', '7.14', '8.1' ]
  relatedFrameworks:
  features: [ 'nhi', 'service-concept', 'archetype', 'assignment', 'linked-objects', 'provisioning', 'license-management', 'audit-trail' ]
  implementation:
      overview: >
          MidPoint provide mechanisms to manage non-human identities, such as mobile devices.
      details: >
          MidPoint can manage non-human identities, such as identities for mobile devices (BYOD) or other off-premise assets.
          MidPoint can maintain inventory of the devices and other off-premise assets, using archetypes to distinguish individual asset types.
          Assignments and linked object features can be used to track possession of devices, or responsibility over assets.
          MidPoint can automatically manage permissions necessary for the devices to access information in applications (technical accounts), automatically provisioning and de-provisioning the access.
          Audit trail can be used to record changes in device possession, keeping a log of device transfers.
      rationale: >
          This control is mostly about physical security, which is out of reach of midPoint.
          However, midPoint can provide capabilities to inventory and manage mobile device identities.


- id: '7.10'
  title: 'Storage media'
  category: physical
  control: 'Storage media should be managed through their life cycle of acquisition, use, transportation and disposal in accordance with the organization’s classification scheme and handling requirements.'
  comment: ''
  necessity: not-applicable
  related:
  relatedFrameworks:
  implementation:
      rationale: >
          This control is concerned with physical security only, which is out of reach of midPoint.


- id: '7.11'
  title: 'Supporting utilities'
  category: physical
  control: 'Information processing facilities should be protected from power failures and other disruptions caused by failures in supporting utilities.'
  comment: ''
  necessity: not-applicable
  related:
  relatedFrameworks:
  implementation:
      rationale: >
          This control is concerned with physical security only, which is out of reach of midPoint.


- id: '7.12'
  title: 'Cabling security'
  category: physical
  control: 'Cables carrying power, data or supporting information services should be protected from interception, interference or damage.'
  comment: ''
  necessity: not-applicable
  related:
  relatedFrameworks:
  implementation:
      rationale: >
          This control is concerned with physical security only, which is out of reach of midPoint.

- id: '7.13'
  title: 'Equipment maintenance'
  category: physical
  control: 'Equipment should be maintained correctly to ensure availability, integrity and confidentiality of information.'
  comment: ''
  necessity: not-applicable
  related:
  relatedFrameworks:
  implementation:
      rationale: >
          This control is concerned with physical security only, which is out of reach of midPoint.


- id: '7.14'
  title: 'Secure disposal or re-use of equipment'
  category: physical
  control: 'Items of equipment containing storage media should be verified to ensure that any sensitive data and licensed software has been removed or securely overwritten prior to disposal or re-use.'
  comment: 'mobile devices, BYOD'
  necessity: optional
  related: [ '7.9', '7.10', '8.1', '8.10', '8.24' ]
  relatedFrameworks: [ 'ISO27040' ]
  features: [ 'nhi', 'service-concept', 'archetype', 'provisioning', 'license-management' ]
  implementation:
      overview: >
          MidPoint provide mechanisms to manage non-human identities, which can be used to track equipment and its reuse.
      details: >
          MidPoint can manage non-human identities, such as identities for mobile devices and other equipment.
          MidPoint can maintain inventory of the devices and other equipment, track its possession and re-use.
          MidPoint can automatically manage permissions necessary for the devices to access information in applications (technical accounts), automatically provisioning and de-provisioning the access.
          Audit trail can be used to record changes in device possession, keeping a log of device transfers.
      rationale: >
          This control is mostly about physical security, which is out of reach of midPoint.
          However, midPoint can provide capabilities to inventory and manage mobile device identities.

- id: '8.1'
  title: 'User endpoint devices'
  category: technological
  control: 'Information stored on, processed by or accessible via user endpoint devices should be protected.'
  comment: 'desktops, mobile devices, BYOD'
  necessity: optional
  related: [ '5.12', '7.14', '7.9', '8.9', '8.16' ]
  relatedFrameworks:
  features: [ 'nhi', 'service-concept', 'archetype', 'provisioning', 'synchronization', 'license-management', 'information-classification', 'org', 'rbac' ]
  implementation:
      overview: >
          MidPoint provide mechanisms to manage non-human identities, which can assist in management of user endpoint devices.
      details: >
          MidPoint can manage non-human identities, such as desktop computers, mobile devices and other user endpoint devices.
          Device identities can be synchronized from authoritative data sources (such as devices registered in Active Directory), or maintained manually in midPoint.
          Organizational structure and role-based access control (RBAC) can be used to set up policies on endpoint device use, e.g. allowing bring-your-own-device (BYOD) only for selected organizational units or roles.
          Information classification mechanism can be used to record classification level of the devices, which can be used in the policies.
      rationale: >
          This control deals with remote software maintenance, updates, malware protection, personal firewalls and similar mechanisms, which are mostly out of reach of midPoint.
          However, midPoint can still provide interesting advantages for management of endpoint devices.
# TODO: access control? Usage of web services/apps?

- id: '8.2'
  title: 'Privileged access rights'
  category: technological
  control: 'The allocation and use of privileged access rights should be restricted and managed.'
  comment: ''
  necessity: necessary
  related: [ '5.15', '5.17', '5.18' ]
  relatedFrameworks: [ 'ISO29146' ]
  features: [ 'rbac', 'pdrbac', 'assignment', 'schema-activation', 'entitlement', 'synchronization', 'connid-framework', 'provisioning', 'access-certification', 'micro-certification', 'information-classification', 'access-request-process', 'approval-process', 'policy-rule', 'personas', 'projection-link', 'password-policy', 'protected-accounts', 'audit-trail', 'object-history', 'assignment-metadata', 'role-mining', 'nhi', 'reporting', 'dashboard' ]
  implementation:
      overview: >
          MidPoint has numerous features to support management of privileged access rights.
      details: >
          Privileged access rights can be represented as entitlements in midPoint, their assignment to users is recorded, tracked and synchronized from identity resources.
          Given sufficient coverage by identity connectors, midPoint can have comprehensive record of privileged access rights assignments across the organization.
          Role-based access control (RBAC) is primary mechanism for organization and automation of privileged access rights management.
          RBAC can be used to assign privileged access rights to appropriate roles or business responsibilities, automating assignment of privileges to users.
          Even more importantly, RBAC automates unassignment of privileged access rights, automatically removing unnecessary privileges.
          Furthermore, policy-based RBAC is extending the access control with dynamic rules, which further organizes and automates management of privileged access rights.
          Role-based mechanisms and policies can be used to make sure that the "minimum requirement" criterion of this control can be satisfied.
          Privileged access rights determined by the policies can be automatically provisioned to user accounts, and automatically de-provisioned (revoked) as needed.
          Assignment of privileged access rights to the users are recorded in midPoint, including the meta-data, which satisfies the recording requirement of this control ("record of all privileges allocated").
          Role mining capabilities can be used to find patterns in usage of privileges, creating appropriate business roles.
          This approach increases the degree of automation and reliability of privileged access rights management.
          Privileges access rights that cannot fit into business roles can be managed by access request process, subject to appropriate approval.
          Policy rules can be used to make sure requests for privileged access are subject to additional approval step, and cannot be assigned without explicit approval, which satisfies requirement of this control for "maintaining an authorization process".
          MidPoint provides ability to assign privileged access rights temporarily, using activation schema in the assignment.
          Access certification campaigns can be used to regularly review and certify assignment of privileged access rights.
          Micro-certifications can be used to momentarily review privileged access rights of a user when an important change or event occurs, such re-assignment of the user in organizational structure.
          Mechanisms of information classification and clearances can be used to make sure user has appropriate competence for use of privileged access rights.
          Personas can be used to create separate identities for users that accumulate significant amount of privileged access rights, such as system administrators.
          Such users can have special personas with privileged access rights, separated from their common user personas.
          Such privileged personas may be subject to stricter security requirements, such as requirement for stronger password or multi-factor authentication.
          Special accounts in identity resources can be marked as "protected", avoiding any unintended modification, linking or other abuse of the accounts.
          This mechanism can be used to protect emergency and hardwired accounts such as "root" or "administrator", avoiding unintended use of such accounts.
          Capabilities for management of non-human identities (NHI) can be used to manage application accounts, accounts that represent devices and other technical accounts.
          Such accounts can be managed with the same mechanisms as user accounts, using roles, policies and approval processes as necessary.
          Reporting and dashboarding capabilities can be used to list all privileged access and apply analytics for better understanding and improvements of privileged access structure.
          Audit trail provides complete record of changes in privileged access right assignments.
      rationale: >
          MidPoint provides numerous features to properly manage privileged access rights at scale.
          Management of privileged access rights in medium-to-large organizations without such features is very unrealistic.
          Manual management of privileged access rights at such scale is certain to require huge effort, while being slow to react and very unreliable.
          Strong identity administration and governance (IGA) platform such as midPoint is absolutely necessary to satisfy this control in larger organizations.
      notes:
          - >
              MidPoint fully supports and encourages assignments of privileged assignments to personalized accounts of the users, avoiding use of shared accounts and accounts with generic user identifiers (such as "root" or "administrator").
              MidPoint supports indirect approaches, such as the "sudo" mechanism, or "Domain Admins" group.
              Roles and entitlements in midPoint are designed to assign privileged access rights to user accounts, recording them, managing them and revoking them as necessary.
# TODO: notification "you have privileged access now, you should behave"
# TODO: later: connid support for "privileged" flag.
# TODO: 4.9: outlier detection

- id: '8.3'
  title: 'Information access restriction'
  category: technological
  control: 'Access to information and other associated assets should be restricted in accordance with the established topic-specific policy on access control.'
  comment: 'no anon access, configurable autz (not hardwired), rwdx, "dynamic access management", DRM'
  necessity: necessary
  related: [ '5.12', '5.15', '5.16' ]
  relatedFrameworks: [ 'ISO29146' ]
  features: [ 'user-concept', 'provisioning', 'entitlement', 'identity-repository', 'rbac', 'assignment', 'org', 'service-concept', 'inducement', 'archetype', 'parametric-role', 'relation', 'synchronization', 'schema-activation', 'information-classification', 'policy-rule', 'audit-trail' ]
  implementation:
      overview: >
          MidPoint is an essential tool for managing information access restriction, supporting it with numerous features.
      details: >
          MidPoint is designed to manage access control rules and policies, restricting access to information by particular user or group.
          MidPoint entitlements represent permissions, restricting access to information in applications and databases.
          Entitlements are applied to user accounts by provisioning mechanism.
          Synchronization mechanism keeps entitlements consistent with access control policies.
          User records and assignments stored in midPoint identity repository record access rights assigned to particular users.
          Activation schema can be used in assignments to grant temporary permissions.
          Organization units (representing groups, divisions, teams, projects, etc.) and roles (representing jobs and business responsibilities) are used to group users, applying policies consistently across the organization using roles-based access control (RBAC) principles.
          Entitlements are derived from RBAC mechanisms, considering additional dynamic policies, applying the entitlement to user accounts using provisioning mechanisms.
          Fine-grained access control policies can be applied to various objects, such as file shares, data partitions and spaces and documents.
          Relevant data objects can be synchronized to midPoint, usually in a form of "services" with an appropriate archetype.
          Mechanism of parametric roles can be used to control access to such objects, using relation parameter to specify access level (e.g. read, write, administration).
          Information classification mechanisms can be used to set high-level access policies for class of applications, e.g. allowing public and anonymous access only to applications processing public data.
          This provides partial isolation of sensitive applications, ensuring that only users with appropriate clearances get access to sensitive information.
          Audit trail records all changes in access control permissions.
          This information can be used for reference, investigation or analysis.
      rationale: >
          Management of information access restrictions is an extremely demanding task, especially when it needs to be done on scale.
          It requires establishing of access control policies, and consistent enforcement of the policies across many applications and identity resources.
          Identity administration and governance (IGA) platform such as midPoint is necessary to satisfy this control in any medium-to-large organization.
      notes:
          - >
              MidPoint relies on access control enforcement in applications and identity resource.
              Applications are policy decisions points (PDP) and, more importantly, policy enforcement points (PEP).
              MidPoint is managing and distributing the policies, being a policy administration point (PAP).
          - >
              This control requires "configuration mechanisms to control access", which effectively prohibits hard-coded access control rules in the application.
              Applications have to expose entitlements, which can be assigned to accounts.
              MidPoint is designed to manage such entitlement assignments using its role-based mechanisms and policies.
          - >
              The control describes advantages of "dynamic access management" mechanism in length.
              However, it is not clear how is such a mechanism supposed to work.
              Probably the closest implementation could be a variation of digital rights management (DRM) mechanism, which is notoriously difficult to use, a mechanism with questionable reliability.
              We recommend not to follow the guidance for "dynamic access management", and rather rely on reliable application of proven and established access control techniques.


- id: '8.4'
  title: 'Access to source code'
  category: technological
  control: 'Read and write access to source code, development tools and software libraries should be appropriately managed.'
  comment: 'modeling tools, source code management system, CI/CD, artifact repositories'
  necessity: necessary
  related: [ '5.8', '5.15', '5.18', '8.3', '8.32' ]
  relatedFrameworks: [  ]
  features: [ 'pdrbac', 'provisioning', 'connid-framework', 'assignment', 'org', 'service-concept', 'relation', 'parametric-role', 'inducement', 'archetype', 'identity-lifecycle', 'persona', 'audit-trail' ]
  implementation:
      overview: >
          MidPoint can manage access control setting of source code management systems, CI/CD and testing platforms and other software development systems.
      details: >
          Strong provisioning capabilities of midPoint, together with appropriate ConnId connectors, can be used to manage access control in numerous software development systems and platforms.
          MidPoint can control access of individual developers to specific source code repositories in source code management systems, pipelines in continuous integration and delivery (CI/CD) platforms, testing environments and all other systems related to software development.
          Access to the software development tooling can be controlled in an automated way, using policy-driven role-based access control (PD-RBAC).
          Developers can gain access to individual repositories, pipelines and environments based on their membership in teams or projects, their access level (read/write) determined by their position or role in the project.
          Fine-grained access control for setting up access levels can be implemented using relation parameter, together with parametric inducements in archetypes corresponding to source code repositories.
          Access that is automatically granted using PD-RBAC mechanism is automatically adjusted or revoked when the membership, position or role of the developer changes.
          Access to source code repositories can be seamlessly integrated with project management, automatically creating source code repositories and granting permissions for project members, revoking permissions when members leave the project.
          Similarly, access to source code can be managed for suppliers, contractors and consultants, granting access as they join a project and revoking it when they leave.
          Automation provided by PD-RBAC mechanisms makes sure that the access will be reliably revoked, keeping risks manageable.
          When needed, special-purpose personas can be created for "testing identities", identities of quality assurance engineers that group testing accounts (as opposed to their ordinary user accounts).
          MidPoint audit trail records all changes in permissions, including source code access right changes.
      rationale: >
          MidPoint is necessary to manage access control to source code and other software development tools and platforms at scale.
          While access to a small set of source code repositories can be managed manually, manual management becomes infeasible as the organization grows.
          Large number of organizational units, team, activities and projects present various needs for source code management and permissions.
          Excessive access rights for source code repositories may remain unnoticed for years, yet they pose a serious security risk.
          Management of source code repository access has to be automated - especially revocation of access rights.
          This problem is especially emphasized in large software development companies or IT consultancies that conduct large number of projects, many of them are relatively short-lived.
          Frequent change of staff assignments, moving people between projects, engagement of suppliers/contractor/consultants and similar dynamic business behavior requires strong identity governance platform to operate in a secure manner.
      notes:
          - >
              Process known as "pull request", described as "authorization procedure" by the control, is implemented by source code management platforms.
              MidPoint does not take part in this process directly.
              However midPoint can control permissions to allow certain team members to review and merge pull requests, "authorizing" source code changes.
          - >
              MidPoint can be especially helpful for controlling access to testing environments, especially of there are copies of production data.
              Testing environments are notorious for lax management of assess rights and poor cleanup of access permissions after test.
              MidPoint can manage access permissions of quality assurance staff and scan the systems for testing accounts that are not accounted for.
# Example: fine-grained access control
