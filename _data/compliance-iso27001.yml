- id: '5.1'
  title: 'Policies for information security'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Information security policy (top management), topic-specific policies'
  necessity: optional
  features: [ 'reporting', 'simulation', 'audit-trail', 'application-inventory', 'dashboard' ]
  igaCapabilities: [ 'identity-analytics' ]
  implementation:
      overview: >
          MidPoint can provide essential data for definition and maintenance of security policies.
      details: >
          MidPoint reporting can be used to extract information from identity data (identity analytics).
          Simulation capabilities can be used to predict the effect of proposed policies, especially for topic-specific policies.
          Dashboards can be used to keep track of application, enforcement and violations of the policies.
# Example: report for topic-specific policy?

- id: '5.2'
  title: 'Information security roles and responsibilities'
  category: organizational
  type: [ 'preventive' ]
  comment: 'RBAC, mostly for security personnel'
  necessity: necessary
  related: [ '5.1' ]
  features: [ 'rbac', 'role-governance', 'simulation', 'application-inventory', 'org', 'certification', 'escalation' ]
  igaCapabilities: [ 'policy-and-role-management' ]
  implementation:
      overview: >
          MidPoint provides essential management capabilities of roles and responsibilities by using its advanced role-based access control (RBAC) mechanisms.
      details: >
          Roles can be defined in midPoint, including all necessary privileges, role hierarchies, policies and descriptive data, especially for security personnel (e.g. security manager).
          Role governance can be managed in midPoint, recording business owners, custodians and approvers responsible for day-to-day operation.
          Such governance approach can be applied to roles, application catalog and other aspects of midPoint, getting governance closer to assets.
          Organizational structure can be used to assign collective responsibilities, e.g. common responsibilities and privileges of security teams.
          Escalation capability can be used to maintain accountability of upper management, making sure that the delegated responsibilities are conducted in a timely manner.
          Simulation capability can be used to predict effects of role model changes.
      rationale: >
          MidPoint is necessary for consistent application of security roles and responsibilities.
          Security personnel often have elevated privileges.
          MidPoint can make sure the privileges are properly recorded, that they are automatically revoked when needed, that the privileges are regularly re-certified.
          While, in theory, this can be done manually, it is not practical and there may be issues in consistent management of privileges and their timely revocation.
# TODO: needs more work, compare with other RBAC-related controls
# Example: (with 5.15, 5.18) Role owners, application owners, Security office team, ???

- id: '5.3'
  title: 'Segregation of duties'
  category: organizational
  type: [ 'preventive' ]
  comment: 'SoD'
  necessity: necessary
  features: [ 'sod', 'policy-rule', 'meta-role', 'gradual-policy-enforcement', 'approval-process', 'authorization', 'reporting' ]
  igaCapabilities: [ 'policy-and-role-management' ]
  igaFunctions: [ 'sod' ]
  implementation:
      overview: >
          MidPoint can manage, monitor and enforce segregation of duties (SoD) policies through the organization.
      details: >
          Segregation of duties (SoD) policies can be defined on role level (role exclusion) or role-class level (meta-role), with selective enforcement.
          The policies can be enforced gradually, reporting policy violations first, gradually addressing them, applying full policy enforcement when all violations are addressed.
          SoD violations can be optionally driven through approval process to "legalize" them.
      rationale: >
          MidPoint is necessary, as SoD policy cannot be practically enforced manually on large number of roles, and large number of role assignment changes.
          SoD evaluation and enforcement must be automated to be practical.
      plan: >
          Add SoD widget to pre-configured Compliance dashboard.
          Create sample and docs configurations for gradual SoD enforcement.
# Example: SoD gradual enforcement: define SoD policy, report violations, set up dashboard, clean up violations, enforce the policy
# CONFIG: pre-configured reports: SoD policies (roles with SoD exclusions), SoD violations

- id: '5.4'
  title: 'Management responsibilities'
  category: organizational
  type: [ 'preventive' ]
  necessity: not-applicable
  related: [ '6.3' ]

- id: '5.5'
  title: 'Contact with authorities'
  category: organizational
  type: [ 'preventive', 'corrective' ]
  necessity: not-applicable
  related: [ '5.24', '5.28', '5.29', '5.30' ]

- id: '5.6'
  title: 'Contact with special interest groups'
  category: organizational
  type: [ 'preventive', 'corrective' ]
  necessity: not-applicable
  related: [ '5.24', '5.28' ]

- id: '5.7'
  title: 'Threat intelligence'
  category: organizational
  type: [ 'preventive', 'detective', 'corrective' ]
  necessity: marginal
  features: [ 'object-lifecycle', 'audit-trail', 'object-metadata', 'object-history', 'reporting' ]
  igaCapabilities: [ 'lifecycle' ]
  implementation:
      overview: >
          MidPoint can provide additional information for operational threat intelligence, such as current or past access rights of users affected by a threat.

- id: '5.8'
  title: 'Information security in project management'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Project management'
  necessity: necessary
  related: [ '5.12', '5.32', '8.26' ]
  features: [ 'org', 'archetype', 'delegated-administration', 'relation', 'authorization', 'information-classification', 'policy-rule' ]
  igaCapabilities: [ 'lifecycle', 'policy-and-role-management' ]
  igaFunctions: [ 'organizational-structure' ]
  implementation:
      overview: >
          MidPoint can manage projects as organizational units, including project governance information (managers, sponsors, reviewers).
      details: >
          Privileges necessary for project members and managers can be assigned automatically.
          As midPoint organizational structures act as roles (abstract roles), all necessary policies and privileges for project can be defined centrally (project meta-role or archetype) or on per-project level.
          Projects can be automatically represented by entitlements, e.g. automatically creating and managing Active Directory groups for projects.
          Information classification labels can be applied to projects, manually or automatically (
          Delegated administration can be used to allow project managers to control certain aspects of the projects (e.g. project name, description and membership).
          Policy rules can report or enforce validity and consistency of project structure, e.g. making sure that all projects have at least one manager.
      rationale: >
          MidPoint is necessary, as the project-related policies cannot be practically enforced manually on large number of roles, and large number of project membership changes.
          If not automated, access rights associated with the projects are usually assigned to users, and never removed.
          Retaining access rights related to closed projects and former project members usually result in  severe over-provisioning.
          Access control related to project management must be automated to be secure and practical.
      plan: >
          Add "project" as a built-in pre-configured archetype.
          Create sample and docs configurations for project management.
# Example: Project management: manage AD project groups, manage membership, authorizations for project manager to modify project (maybe members)

- id: '5.9'
  title: 'Inventory of information and other associated assets'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Asset management'
  necessity: optional
  related: [ '5.10', '5.12', '5.13' ]
  features: [ 'role-governance', 'application-inventory', 'relation' ]
  igaCapabilities: [ 'lifecycle' ]
  implementation:
      overview: >
          MidPoint can manage applications, roles and entitlements that are closely related to assets.
      details: >
          Application inventory capability of midPoint is essential first step to catalog assets.
          MidPoint capability to maintain various relations of objects can be used to track owners of applications, roles and other asset-related objects.
          Applications without owners can be reported.
          Applications can be classified, setting classification-specific requirements and policies on applications.
          Application roles are linked to the application, enabling application-level policies to be applied to all users using the application.
      plan: >
          Introduce "asset" as a first-class citizen in midPoint (later, in synergy with risk assessment).
# Example: Compliance dashboard: roles without owners, applications without owners, applications without classification.

- id: '5.10'
  title: 'Acceptable use of information and other associated assets'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Acceptable use of assets, informing users, recording access, marking and protecting media'
  necessity: optional
  related: [ '5.12', '5.18', '7.8', '7.10' ]
  features: [ 'assignment', 'assignment-metadata', 'audit-trail', 'object-metadata', 'object-history', 'notification' ]
  implementation:
      overview: >
          Audit trail, object history and meta-data can be used to record access rights information.
      details: >
          MidPoint assignments provide a record of authorized users of information, including meta-data recording reasons for assigning the rights.
          Notifications can be used to deliver guidance on acceptable use of the system at the moment the account is created on the system.
          MidPoint can use audit trail to record access rights of users that have or had access to assets.
          Object history feature can be used to reveal access rights or users related to an asset in the past.
      plan: >
          Provide ability to inform user when gaining a privilege, asking user to confirm acceptance of terms before assigning the privilege.
# Example: audit log analysis?

- id: '5.11'
  title: 'Return of assets'
  category: organizational
  type: [ 'preventive' ]
  necessity: marginal
  related: [ '5.18', '5.24', '7.14' ]
  comment: "license management? Device ownership tracking? \"Auth hardware\" - tokens"
  features: [ 'service', 'projection-link' ]
  implementation:
      overview: >
          MidPoint can record ownership of devices, tokens and licenses using the concept of "service".
      details: >
          Projection links can be used to link to device/token tracing in external systems (e.g. physical security systems).
# TODO: license management?

- id: '5.12'
  title: 'Classification of information'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Establishing classification policy ("rules"), classification scheme, accountability of asset owners'
  necessity: optional
  related: [ '5.13', '5.14' ]
  # Strong?
  features: [ 'information-classification', 'role-governance', 'rbac', 'policy-rule', 'archetype' ]
  implementation:
      overview: >
          MidPoint has a native information classification feature, which can be used to set up classification and clearance schemes.
      details: >
          There are pre-configured archetypes for classifications and clearances in midPoint, that can be used to build classification and clearance schemes.
          Policy rules can be used to set up requirements for individual classifications and applied transitively to all objects giving access to classified asset (usually roles).
          Classification is a generic mechanism, that can apply to variety of objects: roles, organizational units, projects and services.
          Role governance features can be used to track owners accountable for assets - and even custodians for individual classifications and clearances.
      notes:
          - >
              Control for access control (5.15) asks for consistency between access rights and classification (controls 5.12, 5.13), which is given in midPoint by employing policy rules in classifications.
# Maybe add SANS example for classification?
# Example: TLP protocol?
# TODO: access certification? Replacing classifications, not unassigning them.

- id: '5.13'
  title: 'Labelling of information'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Implementing classification policy ("rules"), using classification scheme on applications, roles, etc.'
  necessity: optional
  related: [ '5.12', '5.14' ]
  features: [ 'information-classification', 'application-inventory', 'assignment', 'rbac' ] # TODO: admin-gui?
  implementation:
      overview: >
          Applications can be classified using the defined classification scheme.
      details: >
          Classification schemes can be applied to almost all midPoint objects, most notably applications and roles, efficiently creating information labels.
          Policies specified for the classifications can be enforced by using policy rules.
          Policy rules are applied transitively, even if classified applications are included in business roles.
      notes:
          - >
              Control for access control (5.15) asks for consistency between access rights and classification (controls 5.12, 5.13), which is given in midPoint by employing policy rules in classifications.
# TODO: waiting for better visibility of labels in GUI
# TODO: access certification? Replacing classifications, not unassigning them.

- id: '5.14'
  title: 'Information transfer'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Limiting information transfer to third parties, e.g. allow access to information only to internal users and externals with NDA'
  necessity: optional
  related: [ '5.10', '5.12', '5.13', '5.31', '5.32', '5.33', '5.34', '8.7', '8.24' ]
  features: [ 'information-classification', 'policy-rule', 'rbac', 'archetype' ]
  implementation:
      overview: >
          MidPoint can use classifications and policy rules to limit and partially control information transfer.
      details: >
          Policy rules can prohibit access to internal information to external users, or it may require appropriate non-disclosure agreements in place (in a form of clearance).

- id: '5.15'
  title: 'Access control'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Umbrella control, referencing many other controls'
  necessity: necessary
  related: [ '5.3', '5.10', '5.12', '5.13', '5.16', '5.17', '5.18', '5.31', '5.32', '5.33', '5.34', '7.2', '7.3', '7.4', '8.2', '8.3', '8.4', '8.5', '8.18', '8.26' ]
  features: [ 'rbac', 'pdrbac', 'entitlement', 'role-wizard', 'delegated-administration', 'application-concept', 'meta-role', 'parametric-role', 'sod', 'information-classification', 'policy-rule', 'audit-trail', 'object-history', 'access-certification', 'micro-certification', 'role-governance', 'approval-process', 'applicable-policies', 'access-request-process', 'nhi', 'simulation' ]
  implementation:
      overview: >
          Policy-driven role-based access control mechanism of midPoint can be used as a solid framework for a topic-specific policy on access control, especially the Policy-driven RBAC mechanism.
      details: >
          MidPoint roles can determine entitlements used to enforce access control rules on a fine level.
          Access control rules can be applied both to human users, and non-human identities.
          Role wizard can be used by owners of information to set up appropriate roles for controlling access to the information.
          Concept of application can be used to specify application-specific access control rules and policies.
          For special cases requiring complex and flexible configurations, parametric roles and meta-roles can be used.
          Segregation of duties (SoD) mechanism as well as other policy rules can be an integral part of access control policy, observing applicable legislation and contractual obligations.
          Access request process with appropriate approvals can be used to allow access in a controlled manner, certification mechanism can be used to review the access.
          Changes in access control policy are recorded in audit trail.
      rationale: >
          The main functionality of midPoint is focusing on the access control.
          This is a very important domain for midPoint and without using midPoint it may be hard for organizations to be compliant with this control.
          MidPoint can be the “one tool” needed to correctly manage access control policy from one place and it can provide proof regarding access control policy and the implemented reality.
      notes:
        - >
            This is an "umbrella" control, setting a general access control requirements, referencing numerous other controls to fill in the details.
            Implementation details are provided in the description of referenced controls.
            See the list of related controls for more information.
        - >
            Control description mentions "roles" and RBAC as a suggestion for access control mechanism.
            It also mentions elements of dynamic access control, which is represented in midPoint by the policy-driven RBAC concept.
        - >
            Control description asks for consistency between access rights and classification (controls 5.12, 5.13), which is given in midPoint by employing policy rules in classifications.
        - >
            Role wizard, together with delegated administration capabilities, can be essential tools to delegate definition of role-based policies to the business users.
            MidPoint's ability to pre-define policies (a.k.a. "applicable policies") can be used to pre-package policy elements for business people to attach to roles they prepare.
        - >
            Simulation capability is a powerful tool to predict changes in access control policy, avoiding costly and dangerous disasters.
# TODO: "segregation of access control functions"
# TODO: need-to-know, need-to-use and least privilege principles
# Example: (with 5.18) delegate creation of business roles, using role wizard
# Example: (with 5.18) use "applicable policies" to set up access-and-approval scheme. Use pre-congifured policies for app-owner and role-owner approval, setup of approval by manager.

- id: '5.16'
  title: 'Identity management'
  category: organizational
  type: [ 'preventive' ]
  comment: 'identity lifecycle, identifier management, correlation'
  necessity: necessary
  related: [ '5.17', '5.18', '5.19' ]
  features: [ 'identity-lifecycle', 'projection-link', 'provisioning', 'schema-activation', 'projection-policy', 'common-identity-model', 'iteration', 'sequence', 'expression', 'mapping', 'identity-repository', 'resource-schema', 'correlation', 'approval-process', 'nhi', 'assignment', 'rbac', 'audit-trail', 'object-metadata', 'assignment-metadata', 'value-metadata', 'access-certification', 'information-classification', 'access-request-process', 'schema-activation', 'entitlement', 'nhi', 'application-inventory' ]
  implementation:
      overview: >
          MidPoint platform with all of its features is designed to support identity management and all its aspects.
      details: >
          MidPoint can manage complete identity lifecycle, including both human and non-human identities.
          MidPoint can make sure that "unique identification of individuals and systems", as required by the control, is applied consistently and comprehensively.
          Features related to identity lifecycle management and synchronization are primary features to implement this control.
          Inbound synchronization from HR system (or similar data source) is the usual method to make sure access is de-provisioned in a timely manner, as required by the control.
          MidPoint is a natural choice for aggregation and management of user attributes, organizational and group membership, supporting processes for change of information relating to identities.
          User clearances can be managed and re-certified in midPoint.
          Projection links, synchronization and correlation can be used to make sure the identities are not duplicated.
          Proper identity management mechanisms are applied to avoid use of shared identities.
          MidPoint is designed to fully address de-provisioning of access, as required by the control.
          Audit trail is used to record all identity-related events and configuration changes.
      rationale: >
          The main functionality of midPoint is focusing on the identity management and supporting the whole life cycle of identities with proper documentation of each step and logs.
          Customers can create procedures for providing and revoking access to information with proper verification and approval.
      notes:
          - >
              This is the primary control supporting deployment of midPoint in organizations.
              Almost all midPoint features are more or less related to this control.
          - >
              Requirements of this control reach beyond the scope of IGA, mostly to systems that act as a source of information for midPoint.
              E.g. the control asks for confirming of business requirements for an identity, verifying it and establishing an identity.
              When dealing with employee identities, this requirements is satisfied by the usual HR practices and processes.
              MidPoint is taking processed information from the HR systems, assuming that the requirements are already satisfied.
          - >
              Application inventory provides "unique identification of systems", it can also be used for partial management of non-human identities (service accounts).
# TODO: Example: synchronization with correlation

- id: '5.17'
  title: 'Authentication information'
  category: organizational
  type: [ 'preventive' ]
  comment: 'mostly password management'
  necessity: necessary
  related: [ '6.2', '8.24' ]
  relatedFrameworks: [ 'ISO24760' ]
  features: [ 'password-management', 'password-policy', 'audit-trail', 'self-service-gui', 'self-service-password-reset' ]
  implementation:
      overview: >
          MidPoint is designed to manage authentication information, especially passwords.
      details: >
          MidPoint is built to distribute authentication information to target systems, making sure that the passwords are strong and up-to-date.
          MidPoint self-service user interface can be used to manage authentication information by users, including interactive indication of password strength.
          Password complexity and lifetime policies can be specified, enforced and they can also be used to generate strong passwords.
          MidPoint can be used to quickly change password or deactivate accounts on all connected systems, in an event of password compromise.
          Events related to change of authentication information are recorded in audit trail.
      rationale: >
          MidPoint can improve authentication level in a company by centrally enforcing password policy thanks to its password management.
      notes:
          - >
              This control is mostly about password management, it does not deal much with non-password authentication or credentials.
              ISO/IEC 24760 is referenced for that.
          - >
              MidPoint relies on cooperation of an access management (AM/SSO) system to implement most of the authentication and enforcement capabilities.
              MidPoint can manage authentication information, such as passwords or passkeys.
              However, midPoint cannot efficiently deal with authentication itself, or aspect of credential management related to authentication, such as forcing password change on next log-in.
              This functionality has to be implemented in close cooperation with the authentication system.
          - >
              Management of initial passwords and self-service password resets do not have any ideal solution.
              There are numerous trade-offs and compromises to be made.
              The solution has to be custom made for every organization or environment.
              Please see discussion document linked below for more details.
# Example: force password change for a large group of users after security incident?


- id: '5.18'
  title: 'Access rights'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Execution of access control policies: request, approval, certification'
  necessity: necessary
  related: [ '5.3', '5.9', '5.12', '5.15', '5.20', '6.1', '6.2', '6.4', '6.5', '6.6' ]
  features: [ 'provisioning', 'pdrbac', 'entitlement', 'access-request-process', 'approval-process', 'application-inventory', 'role-governance', 'access-certification', 'micro-certification', 'assignment', 'assignment-metadata', 'schema-activation', 'policy-rule', 'sod', 'information-classification', 'org', 'role-autoassignment', 'inducement', 'audit-trail', 'object-history' ]
  implementation:
      overview: >
          MidPoint is an essential component to make sure access to information is provisioned, reviewed, modified and removed in accordance with policies.
      details: >
          Access request and approval process can be used to request access, subject the request to appropriate approvals, and automatically provision the access.
          The process makes sure that all relevant approvals are processes before access is granted, dynamically evaluating approval schemes based on individual role definitions.
          Temporal activation constraints ("from" and "to" timestamps) can be used to limit validity of the identity, as well as assignment of access rights to the identity.
          Certification capability can be used to review access rights at regular intervals.
          Moreover, midPoint automatically removes on inactivates access rights of entities who have left the organization.
          Application owners recorded in application inventory can be used as part of the access rights management, taking part in approval and review (certification) processes.
          MidPoint automatically evaluates all applicable policy rules, making sure that segregation of duties (SoD) and information classification rules are maintained.
          MidPoint naturally maintains a central record of all assigned access rights, including assignment meta-data: when was access requested, who has approved access, etc.
          Access rights can be automatically assigned and unassigned according to organizational structure membership, either by using inducement, or by using role autoassignment capability.
          Automatic review of access rights at the moment of organizational membership change can be implemented by micro-certification feature.
          All access right changes are recorded in the audit trail.
      notes:
          - >
              The control asks for consideration of reason of employment termination (among other aspects) for access rights de-provisioning.
              MidPoint is built to de-provision access rights immediately when it learns about employment change.
              However, HR data sources are often integrated using reconciliation, which may have significant time delays.
              Therefore, it should be considered to supplement reconciliation with live synchronization for the HR system.
              Alternatively, manual deactivation process should be established for users where the circumstances of termination of employment suggest elevated risk.
          - >
              The control suggests establishment of user access roles based on business requirements, also known as business roles.
              Role wizard, together with delegated administration capabilities, can be essential tools to delegate definition of business roles to the business users.
              This is yet another place in the standard that suggests use of RBAC.
          - >
              Control description describes access rights cloning (a.k.a. "assign rights as Mr. Smiths has") as an undesirable practice, recommending use of RBAC instead.
# Example: (with 5.15) Access request, approval of application owner, approval of role owner, approval of manager
# Example: (with 5.15) delegate creation of business roles, using role wizard
# Example: Certification campaigns. Maybe considering classification (privileged access rights certified more often).
# Example: inducement of access rights in orgstruct
# Example: micro-certification when org membership changes
# Example: manual deactivation of users, after high-risk termination of employment
# TODO: "segregating the roles of approval and implementation of the access rights"
# TODO: reason for termination


- id: '5.19'
  title: 'Information security in supplier relationships'
  category: organizational
  type: [ 'preventive' ]
  comment: 'risks associated with the use of supplier’s products or services, internal procedures'
  necessity: optional
  related: [ '5.10', '5.11', '5.12', '5.13', '5.14' ]
  relatedFrameworks: [ 'ISO27036-2', 'GDPR' ]
  features: [ 'identity-lifecycle', 'archetype', 'provisioning', 'pdrbac', 'inducement', 'policy-rule', 'org', 'application-inventory', 'entitlement', 'access-certification', 'schema-activation', 'information-classification', 'notification' ]
  implementation:
      overview: >
          Supplier identities can be managed by midPoint, including their access rights and relation to supplier organizations.
      details: >
          Supplier identities, such as contractors or support engineers can be recorded in midPoint, using specific archetypes, applying specific policies (inducements in the archetypes, policy rules).
          MidPoint records all access granted to the supplier, allowing assessment of risk posed by individual supplier identities.
          Organizational structure can be used to group such external identities with respect to their mother companies, making sure all supplier identities and access rights are properly de-provisioned when contract with specific supplier is terminated.
          Classification can be used to limit supplier's access to classified information based on hard policy, e.g. prohibiting supplier identity to gain any role which gives access to systems classified as "sensitive".
          Application inventory can be used to catalog third-party (cloud) services used by the organization, including all entities that have access to them.
          Classifications can be used to categorize cloud services, according to provided level of security and sensitivity of information stored there.
          Notifications can be used to communicate security policies and rules for acceptable use of information to suppliers, when gaining access to systems.
      rationale: >
          MidPoint can manage access rights of suppliers, e.g., by creating temporary access rights automatically revoked on expired date,
          by creating a business role especially created for a specific supplier that can be easily monitored (who has access to that role) and revoked.
      notes:
          - >
              Personal information protection should be considered when working with supplier, especially if cross-border transfer is involved,
              even more importantly in case of information transfer outside EU (see GDPR).
              MidPoint can provide an advantage in case that all personal information transfer is mediated by midPoint, as midPoint maintains record of information transfer,
              and it can also make sure that information erasure is properly initiated.
# TODO: license management

- id: '5.20'
  title: 'Addressing information security within supplier agreements'
  category: organizational
  type: [ 'preventive' ]
  comment: 'making sure suppliers have the right contractual obligations, incident management'
  necessity: optional
  related: [ '5.10', '5.12', '5.13', '5.14' ]
  relatedFrameworks: [ 'ISO27036-2', 'ISO19086', 'GDPR' ]
  features: [ 'identity-lifecycle', 'archetype', 'password-management', 'application-inventory', 'information-classification', 'audit-trail', 'object-history' ]
  implementation:
      overview: >
          Some of the supplier contractual agreements can be enforced by midPoint policies.
      details: >
          This controls deals mostly with contractual obligations, not so much with technical controls and measures.
          Most of the measures described in control 5.19 can be used to implement the contractual clauses of this control.
          MidPoint can make sure that access is granted to supplier identities only after all necessary contracts are in place (using clearance mechanism),
          e.g. only allowing access to users that have signed personal non-disclosure agreements.
          Audit trail and object history features can provide valuable information during management of incidents involving supplier identities and actions.
# TODO: license management


- id: '5.21'
  title: 'Managing information security in the ICT supply chain'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Product and service certification (CC), SBOM, anti-tampering, including cloud and IoT; mostly contractual'
  necessity: marginal
  related: [ '5.10', '5.12', '5.13', '5.14', '5.19', '5.20' ]
  relatedFrameworks: [ 'ISO27036-3', 'ISO19770-2', 'CC', 'CRA' ]
  features: [ 'application-inventory', 'information-classification', 'policy-rule' ]
  implementation:
      overview: >
          MidPoint can provide inventory of applications, including their classifications.
      details: >
          This controls deals mostly with contractual obligations and organizational procedures, not so much with technical controls and measures.
          However, there are some advantages that midPoint can provide.
          Application inventory can be used to catalog third-party (cloud) services used by the organization.
          Classifications can be used to categorize the services, according to demonstrated certifications applicable to the services.
          Policy rules can be used to limit access to services with insufficient security levels or certifications.


- id: '5.22'
  title: 'Monitoring, review and change management of supplier services'
  category: organizational
  type: [ 'preventive' ]
  comment: 'Monitor updates to cloud applications, product updates'
  necessity: marginal
  related: [ '5.19', '5.20', '5.21', '5.29', '5.30', '5.35', '5.36', '8.14' ]
  relatedFrameworks: [ 'ISO27036-3' ]
  features: [ 'application-inventory', 'information-classification', 'policy-rule' ]
  implementation:
      overview: >
          MidPoint can provide some monitoring and inventory capabilities for applications.
      details: >
          This controls deals mostly with organizational procedures, not so much with technical controls and measures.
          However, there are some advantages that midPoint can provide.
          Application inventory can be used to catalog third-party (cloud) services used by the organization, which can be used as a basis for regular review, e.g. review of classifications.
          MidPoint can monitor some activity of users on the applications.
          E.g. midPoint can detect an application that was used recently, or application that is used only by a fraction of users that have access to it.


- id: '5.23'
  title: 'Information security for use of cloud services'
  category: organizational
  type: [ 'preventive' ]
  comment: 'acquisition, use, management and exit from cloud services, collaborative effort'
  necessity: optional
  related: [ '5.21', '5.22' ]
  relatedFrameworks: [ 'ISO17788', 'ISO17789', 'ISO19086', 'ISO19941', 'ISO22123-1', 'ISO27017', 'ISO27018', 'ISO27036-4' ]
  features: [ 'identity-lifecycle', 'connid-framework', 'provisioning', 'pdrbac', 'application-inventory', 'entitlement', 'information-classification' ]
  implementation:
      overview: >
          MidPoint can automatically manage access to cloud services.
      details: >
          This control deals mostly with contractual arrangements with cloud service providers, it is not focused on technical measures.
          However, midPoint plays an important role in managing cloud services at large.
          MidPoint is designed to manage access control to cloud services, creating accounts, assigning accounts to groups, granting and revoking privileges.
          Application inventory capability can be used to catalog cloud services in the first place, enabling classification of cloud services based on level of security or sensitivity of processes information.
          MidPoint can quickly provision access to a new application in case that an existing cloud application is disrupted or replaced,
          which is a natural part of exit strategy for almost every cloud application.



- id: '5.24'
  title: 'Information security incident management planning and preparation'
  category: organizational
  control: 'The organization should plan and prepare for managing information security incidents by defining, establishing and communicating information security incident management processes, roles and responsibilities.'
  comment: 'information security incident management processes'
  necessity: optional
  related: [ '5.5', '5.6', '5.25', '5.26', '5.28', '6.8', '8.15', '8.16' ]
  features: [ 'reporting', 'simulation', 'pdrbac' ]
  implementation:
      overview: >
          MidPoint can provide useful information for preparation of incident management plans.
          MidPoint roles can be used to pre-configure emergency access control which can be used during incident response.
      details: >
          Reporting capability of midPoint can be used to provide information necessary for incident response,
          e.g. it can provide information about magnitude of user population that can be effected by certain incident types.
          Simulation capability can be used to predict effects of identity-based incidents, e.g. predict the effect of attacker gaining a particular role in the system.
          MidPoint policy-based RBAC mechanism can be used to pre-configure emergency access privileges for incident responders.
          Such privileges are not active during normal operation, yet they can be easily activated during incident response or emergency.
      notes:
          - >
              Emergency privileges for incident responders are configured in a form of conditional inducements in the usual (business) roles for incident responders.
              The condition evaluates to `false` during normal operation, can be quickly changed to `true` for incident response, which grants the privileges.
              The privileges can be easily removed when incident is handled.
      rationale: >
          Reporting and simulation can provide essential information for planning.
          Ability to pre-configure emergency access control can provide important advantage for rapid incident response.


- id: '5.25'
  title: 'Assessment and decision on information security events'
  category: organizational
  control: 'The organization should assess information security events and decide if they are to be categorized as information security incidents.'
  comment: 'classification of events as incidents'
  necessity: marginal
  related: [ '5.24', '5.26'  ]
  relatedFrameworks: [ 'ISO27035' ]
  features: [ 'identity-lifecycle', 'projection-link', 'schema-activation', 'application-inventory' ]
  implementation:
      overview: >
          MidPoint can provide supplementary information for security event classification.
      details: >
          MidPoint can provide supplementary information for classification of security events.
          E.g. midPoint can provide information whether a user with compromised credentials had access to any systems, or whether the user was inactive.
          Application inventory can provide overview whether any users had access to vulnerable applications, and it can also provide hints whether vulnerable application was used at all.


- id: '5.26'
  title: 'Response to information security incidents'
  category: organizational
  control: 'Information security incidents should be responded to in accordance with the documented procedures.'
  comment: 'incident response, part of incident handling'
  necessity: optional
  related: [ '5.24', '5.25', '5.27', '5.28', '5.29', '5.30' ]
  relatedFrameworks: [ 'ISO27035' ]
  features: [ 'schema-activation', 'audit-trail', 'connid-framework', 'synchronization', 'reporting', 'assignment-metadata' ]
  implementation:
      overview: >
          MidPoint provides essential information for incident response, as well as rapid immediate actions to contain the incident and ensure business continuity.
      details: >
          MidPoint is an essential tool for containing security incidents, allowing immediate deactivation of user access to applications.
          Assignment metadata can be used to provide information about privilege provenance, e.g. when the privilege was assigned, who has approved.
          This is an essential information for incident response, as it may point to affected or compromised identities, provide clues for investigation.
          MidPoint can help with evidence collection, especially by providing information on user access rights and records from its audit trail.
          Reporting capabilities can provide important insights as well, both in containing phase and during evidence collection.
          MidPoint can be a useful tool in escalation phase as well, quickly providing temporary access to ensure business continuity.
          All escalation activities performed by midPoint are properly recorded in midPoint audit trail.

          In case that escalation activities are performed outside of midPoint control, midPoint can be used ex-post to clean up the escalation fallout, discovering temporary accounts and privilege escalation.
          Synchronization capabilities can be used for that purpose.
          Automated identity connectors based on ConnId framework ensure a quick response in the containment phase, as well as rapid escalation and reliable post-incident cleanup.
      notes:
          - >
              Information in assignment metadata can be accessed and interpreted quickly (as opposed to complex audit trail data), which provides significant benefit when rapid incident containment is necessary.
# TODO: move ex-post processing to other controls?
# TODO: necessary?


- id: '5.27'
  title: 'Learning from information security incidents'
  category: organizational
  control: 'Knowledge gained from information security incidents should be used to strengthen and improve the information security controls.'
  comment: 'ex-post incident processing, part of incident handling'
  necessity: optional
  related: [ '5.24', '5.25', '5.26', '5.28', '5.29', '5.30' ]
  features: [ 'audit-trail', 'simulation', 'reporting', 'assignment-metadata', 'synchronization' ]
  implementation:
      overview: >
          MidPoint can provide essential information for ex-post investigation and processing of incidents, covering both the actions of attackers and responders.
      details: >
          MidPoint records all operations in audit trail, including actions of the attackers and responders.
          This information can be used to learn about the incident, as well as evaluate the steps taken to respond to incident.
          Reporting capabilities and assignment metadata can provide essential information about affected identities, as well as provide insights and estimates about vulnerable identities that could be affected in similar incidents in the future.
          Synchronization capability can be used to discover discrepancies between the policy and reality,
          discovering illegal accounts and privileges that were either created by attacker, or that are leftovers from incident response.
          Such information provides important insights to the modus operandi of an attacker, and it manifests flaws in response plans (e.g. missing clean-up instructions).
          Simulation capability can be used to preview the effects of changes that an attacker would make, estimating their effects on access control.
          Simulation can also be used to predict and validate proposed changes to policies, to reflect the post-incident knowledge.
# TODO: necessary?
# TODO: recommendations full sync

- id: '5.28'
  title: 'Collection of evidence'
  category: organizational
  control: 'The organization should establish and implement procedures for the identification, collection, acquisition and preservation of evidence related to information security events.'
  comment: 'collecting data, maintain chain of custody'
  necessity: optional
  related: [ '5.24', '5.25', '5.26', '5.27', '5.29', '5.30' ]
  features: [ 'audit-trail', 'reporting', 'object-metadata', 'assignment-metadata', 'value-metadata', 'synchronization', 'sod' ]
  implementation:
      overview: >
          MidPoint is one of important sources of evidence for incident investigation.
          Additionally, midPoint access control capabilities can be used to preserve evidence.
      details: >
          MidPoint is essential system for identity administration and governance, which makes it one of the most important sources of evidence.
          Reporting capabilities can be used to provide current information, while audit trail and meta-data can provide insights into past state of information before the incident, and changes occurred during the incident.
          Synchronization capability can be used to discover discrepancies between the policy and reality,
          discovering illegal accounts and privileges that were either created by attacker, or that are leftovers from incident response.
          Access control mechanisms, especially the segregation of duties (SoD) mechanism, can be used to assist in evidence preservation.
          E.g. the SoD mechanism can be used to limit possibilities of "history rewriting" by modification of midPoint audit trail, by excluding database administration and midPoint administration roles,
          ensuring that no single person has full control over content of audit trail.
# TODO: recommendations regarding audit trail (insert-only) and log server, full sync

- id: '5.29'
  title: 'Information security during disruption'
  category: organizational
  control: 'The organization should plan how to maintain information security at an appropriate level during disruption.'
  comment: 'be secure during disruption'
  necessity: optional
  related: [ '5.24', '5.25', '5.26', '5.27', '5.28', '5.30' ]
  relatedFrameworks: [ 'ISO22301', 'ISO22313', 'ISO22317' ]
  features: [ 'pdrbac', 'policy-rule', 'information-classification', 'sod', 'synchronization', 'synchronization-reaction', 'provisioning', 'provisioning-consistency', 'object-mark', 'audit-trail' ]
  implementation:
      overview: >
          MidPoint maintains all policies and rules during incident response.
          Pre-configure emergency access control can be used during incident response.
          Synchronization can be used to restore security after disruption.
      details: >
          Policy-driven RBAC mechanism can be used to activate pre-configure emergency access control during disruption, providing controlled and panic-free elevation of privileges for incident responders.
          Segregation of duties, information classification and other policy rules are still applied during disruption (e.g. incident), hindering attempts to create major access control breach by the attacker or the responders.
          Synchronization capability can be explicitly invoked during of after the disruption to make sure access control rules are still properly applied.
          Synchronization can discover illegal accounts and privileges that were either created by attacker, or that are leftovers from incident response.
          Any illegal access can be automatically de-provisioned (deactivated) using synchronization reactions.
          Provisioning consistency capability of midPoint automatically corrects all inconsistencies it discovers, including policy violations.
          Object marks can be used to mark suspicious accounts and roles during disruption for closer investigation at later date.
          Should there be a need to create a replacement system during disruption,
          midPoint RBAC mechanisms together with efficient provisioning engine can be used to quickly and automatically grant access to the replacement system,
          maintaining appropriate access levels for individual users.
          MidPoint audit trail records all changes that were made during disruption using midPoint, or that were discovered by midPoint.
          This information can be used to restore the appropriate level of security after disruption.

- id: '5.30'
  title: 'ICT readiness for business continuity'
  category: organizational
  control: 'ICT readiness should be planned, implemented, maintained and tested based on business continuity objectives and ICT continuity requirements.'
  comment: 'be available during disruption, business continuity, business impact analysis (BIA)'
  necessity: optional
  related: [ '5.24', '5.25', '5.26', '5.27', '5.28', '5.29' ]
  relatedFrameworks: [ 'ISO27031', 'ISO22301', 'ISO22313', 'ISO22317' ]
  features: [ 'ha', 'identity-repository', 'provisioning', 'synchronization', 'provisioning-consistency', 'pdrbac' ]
  implementation:
      overview: >
          MidPoint can be used to quickly prepare replacement system in case of disruption.
          Pre-configure emergency access control can be used during incident response.
      details: >
          MidPoint is designed to work with systems (identity resources) that are not constantly available.
          Operations are re-tried, resource can be explicitly configured for maintenance mode, synchronization capability can be used to restore data consistency.
          Provisioning consistency capability of midPoint automatically corrects all inconsistencies it discovers, which can be used to gradually recover from disruption.
          TODO
          Should there be a need to create a replacement system during disruption,
          midPoint RBAC mechanisms together with efficient provisioning engine can be used to quickly and automatically grant access to the replacement system,
          maintaining appropriate access levels for individual users.
          E.g. midPoint can quickly provision access to a new application in case that an existing cloud application is disrupted.
          MidPoint identity repository contains copies of identity data, which can be used to quickly restore the data to any application.
          Policy-driven RBAC mechanism can be used to activate pre-configure emergency access control during disruption, providing controlled and panic-free elevation of privileges for incident responders.
      notes:
          - >
              MidPoint has a built-in high-availability features.
          - >
              Unavailability of MidPoint does not mean unavailability of identity and access management capabilities.
              MidPoint is designed to provision changes to identity resources, allowing resources to operate independently.
              Unavailability of midPoint means limitation of identity management capabilities, however it does not usually limit operational capabilities of applications.

# Example: identifying users affected by a breach of all passwords on particular application, forcing them to change password.

