= Task
:page-wiki-name: Task and activities
:page-wiki-id: 13074801
:page-wiki-metadata-create-user: semancik
:page-wiki-metadata-create-date: 2013-12-03T17:16:26.193+01:00
:page-wiki-metadata-modify-user: peterkortvel@gmail.com
:page-wiki-metadata-modify-date: 2016-02-20T15:41:50.298+01:00

MidPoint performs virtually every operation through tasks.
Whether it is an atomic change, such as renaming a user in the graphical interface, or a complex job such as synchronizing or reconciling resource objects, all work is carried out by tasks.
This article explains the conceptual foundation of tasks, how they relate to activities, and how leveraging tasks can increase productivity.

== What is a task

In midPoint, a task is unit of work that the execution engine schedules, runs, and monitors.
Think of a task as a container that:

* Has its own lifecycle (ready → running → done / suspended / failed).
* Can be triggered manually, by a cron‑like schedule, or by another task.
* Carries metadata such as a name, description, owner, priority, or retry policy.
* Persists its state (progress, last run time, result) in the repository, meaning it can survive downtimes and restarts.

Tasks for simple changes, such as when you change your password, get created, executed, closed, and deleted under the hood and you cannot inspect or manage them anyhow.
For the more complex jobs, such as import or reconciliation, you can define and tweak various aspects of the task for the job, set it to repeat at defined intervals, or distribute it to selected number of midPoint nodes.

A task itself does not implement the actual business logic itself; instead, it delegates the actual work to be done to one or more activities.

== What is an activity

An activity is the concrete unit of work that lives inside a task.
While a task defines when and under what conditions a job runs, an activity specifies what actually happens during that run.
Each activity contains a work definition that tells midPoint which action to perform (e.g., import, reconciliation, live‑synchronization) and on which set of items it should operate.

Activities can be simple (a single predefined operation) or composite (a sequence of sub‑activities defined by the user).
They are the building blocks that the task scheduler executes, and they report their own status back to the parent task.

=== What are the differences between tasks and activities

[cols="1,2,2"]
.How activities differ from tasks

|=====

| Aspect
| Task
| Activity

| *Purpose*
| Orchestrates when and how work is executed
| Performs the concrete operations that constitute the work

| *Granularity*
| Coarse‑grained; one task may encompass many activities
| Fine‑grained; each activity is a single step (e.g., “import objects”, “reconcile accounts”, “run script”)

| *Scheduling*
| Defined at the task level (cron expression, interval, manual start)
| Inherited from the parent task; activities run according to the schedule of the parent task

| *State tracking*
| Tracks overall progress, success/failure of the whole job
| Reports its own status (started, completed, error) to the parent task, which aggregates the results

| *Configuration*
| Configured via `<task>` elements in the repository or UI (priority, retry, notification)
| Configured via `<activity>` sub‑elements inside a task definition (type, parameters, filters)

|=====

== How tasks help you be more productive

Yes, almost everything midPoint does is a task.
But you yourself can use tasks in midPoint as well to automate jobs you may have done manually up until now.

Modern organizations rely on a growing number of IT systems like Active Directory, SaaS apps, HR databases, etc.
Keeping the data in those systems consistent, up‑to‑date, and compliant is a continuous operational need.
MidPoint tasks give you a reliable, schedule‑driven way to automate such repetitive data‑intensive jobs, freeing staff to focus on higher‑value work while guaranteeing that critical identity‑management processes run on time and can be audited.

=== Example of business case for tasks

Here is an example of how delegating manual work to tasks can save a lot of time.
Managing employee identities across various systems that operate independently requires a great deal of manpower and can lead to costly errors.
When an organization automates this work using tasks, IT professionals can devote their freed‑up time to innovation and help the company progress.

.How tasks help your productivity
[cols="1,2,2"]
|====

| Step
| What the task does
| Business impact

| *Schedule*
| Define a recurring task that runs every night outside business hours
| Guarantees consistent, timely, and automatic sync during off-peak hours

| *Work definition*
| Inside the task, configure an activity to read data from the external resources (AD, HR, etc.) and synchronize them according to the preconfigured mapping and synchronization rules
| Eliminates stale accounts and ensures all employees have the correct access rights across systems

| *Error handling*
| Set the activity error‑handling policy to retry on transient failures and notify the admin on permanent errors
| Reduces the downtime caused by network glitches and provides immediate visibility when something goes awry

| *Reporting*
| Enable the task’s built‑in reporting to generate a daily summary (new accounts, deprovisioned accounts, conflicts resolved) and send it to the security team
| Enables continuous auditing and compliance reporting with minimal effort

| *Scalability*
| Because activities can be parallelized, the task can process thousands of objects concurrently on a multi‑node deployment
| Handles growth in user count without increasing operational overhead

|====

By encapsulating the reconciliation logic into a task, you can turn a labor‑intensive, error‑prone process into a reliable and scalable service that can be audited when needed and free the IT team to focus on higher‑value initiatives while maintaining strict identity governance.

- activities vs. tasks
- foreground vs. background tasks
- see [task manager] for technical description of background tasks

- biz use case for tasks - you can automate things you would need to do manually - like what, eh?
    - e.g. auto import of accounts from HR, periodic (dashboard) report creation

== Introduction

The Task structure provides a context to most midPoint operations and functions.
It contains contextual information such as identity of the user that invoked the operation, it contains security context, it may be bound to scheduling data and so on.
It also holds the xref:/midpoint/architecture/concepts/operation-result/[operation result] data structure.
Each "business" operation in midPoint should be executed in a context of a task.


== Task Manager

Tasks are managed by xref:/midpoint/reference/tasks/task-manager/[Task Manager] component.
The task manager creates the tasks and manages the lifecycle of tasks.
Task manager can create broad range of tasks from lightweight synchronous tasks to a persistent asynchronous and scheduled tasks.
See the xref:/midpoint/reference/tasks/task-manager/[Task Manager] page for more details.


== Task Usage

.Creating a lightweight task instance
[source,java]
----
Task task = taskManager.createTaskInstance(MyClass.class.getName() + ".myOperation");
OperationResult result = task.getResult();
----


== See Also

* xref:/midpoint/reference/tasks/task-manager/[Task Manager]
* xref:/midpoint/reference/tasks/activities/[Activities]