= Notification Redesign in 4.5
:page-toc: top

* Jira task: bug:MID-7484[]
* Existing issues for Notification component: https://jira.evolveum.com/issues/?jql=project%20%3D%20MID%20AND%20component%20%3D%20Notifications[search]

== Known current limitations

* No in-app notifications.
* No notification persistence.
This makes in-app notifications and retrying notifications impossible.
* Few supported transports (email and sms?)
* Missing easy to use templating with multi-language support.

== Open questions

* How to customize various templates?
* How to represent changes, e.g. deltas, in them?
* What states are necessary to support both GUI and various outbound transports?
* What types of notifications are needed for various use cases, e.g. confirmation notification, governance-related notifications, error related notifications...?
What are their specifics?
* Do we want some notification priorities?
Should it be explicit or implicit, e.g. by notification type?
* Do we want notification log?
If notifications are persisted, should that be the log as well?
* May notification be confirmed somehow?
E.g. marking them as _read_ would be possible for GUI, perhaps even for some chat-delivered notifications.
Fire and forget is obviously easier, but even there we want to be sure that it was at least sent/written somehow.
* How to support other types of transport?
Can they be implemented with overlays?
* Do we want to support multiple transports of the same type, e.g. two different mail servers?

== Implementation notes

* Why are transports registering themselves?
What is the difference between `transportRegistry.registerTransport(NAME, this)` and `NotificationManagerImpl.registerTransport`
(which eventually uses the first call) usages?
* Why is `processEvent` version with `EventHandlerType` exposed on API, but used only in the `notifications-impl` module?
* Element `handler` (under `notificationConfiguration`) is of type `EventHandlerType`, and so are many of the nested
elements, e.g. `simpleUserNotifier`.
** Reportedly, there is a kind of "pipes and filters" pattern - but is it this nesting?
There is also a xref:/midpoint/reference/misc/notifications/#special-kinds-of-handlers[handler chain],
but that one is a sequence of handlers, not nested handlers.
I guess, it doesn't make sense to nest stuff like `accountPasswordNotifier` inside each other?
In any case, auto-complete in Studio is rather a mess inside the handlers.

== Existing notification documentation

* xref:/midpoint/reference/misc/notifications/[Notifications] and subpages: xref:/midpoint/reference/misc/notifications/configuration/[Configuring Notifications], xref:/midpoint/reference/misc/notifications/sending-custom-notifications/[Sending custom notifications HOWTO], xref:/midpoint/reference/misc/notifications/general/[General notification - role assignment example], etc.

* Notes in xref:/midpoint/devel/design/efficient-deployment-ideas/[Efficient deployment ideas]:
** How to resend failed e-mail notifications?
** In-app notifications?
** Notification log?

* xref:/midpoint/reference/misc/notifications/task-notifications/[Task Notifications]

* xref:/midpoint/reference/roles-policies/certification/notifications/[Access Certification Notifications]
** Mentioned as a possible timed action in xref:/midpoint/reference/roles-policies/certification/escalation/[Escalation in Certification Campaigns]
** Similar for cases: xref:/midpoint/reference/cases/escalation/[Escalation in Approval Processes]

* xref:/midpoint/reference/cases/workflow-3/workflow-notifications/[Worfklow notifications] and briefly on various workflow pages (how up-to-date are those docs?)

* Mentioned in xref:/iam/iga/workflow/[IGA Capability: Identity Workflow Automation] (Identity Governance and Administration)

* Possible action in xref:/midpoint/reference/misc/bulk/#actions[bulk actions], also
xref:/midpoint/reference/misc/bulk/actions/[in experimental version for 4.2]

* xref:/midpoint/reference/misc/self-registration/#email-notifications[Self-registration] has notifications, so does xref:/midpoint/reference/security/credentials/password-reset/[Password Reset]

* xref:/midpoint/reference/upgrade/migration-from-sun-idm/#notifications[Migration from Sun IdM]

* Mentioned in xref:/midpoint/devel/design/parallel-and-asynchronous-provisioning/[Parallel and Asynchronous Provisioning]

* xref:/midpoint/reference/misc/notifications/sending-custom-notifications/[Sending Custom Notifications]

* xref:/midpoint/devel/testing/test-scenarios/#notifications[Test Scenarios] for notifications (are they up to date?)

Change notifications mentioned in the provisioning context are mostly irrelevant to these Notifications.
