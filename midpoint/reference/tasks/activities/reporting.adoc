= Reporting

Here we describe the definition of reporting for link:../[activities].

[NOTE]
====
Not all of these options are supported for all activities!
Usually, activities that do not support multi-threading (like cleanup)
also do not support these options.
====

[%header]
[%autowidth]
|===
| Item | Meaning | Default

| `logging`
| Controls logging aspects of an activity execution.
| See the description.

| `tracing`
| Specifies when and how should be the activity execution traced.
| No tracing.

| `profiling`
| Specifies when and how should be the activity execution dynamically profiled.
This functionality is deprecated. The tracing should be used instead.
| No profiling.

| `executionReports`
| Configures specific activity execution reports: on buckets, items, and so on.
| No reports.

| `itemCounting`
| How should the activity deal with item counting, i.e. determining "expected progress"
for a bucket or overall.
| TODO

| `stateOverview`
| Parameters related to the maintenance of activity tree state overview.
| TODO
|===

== Logging Configuration

This section defines how should the activity progress be logged.

[%header]
[%autowidth]
|===
| Item | Meaning | Default
| `itemCompletion`
| How should item completion be logged?
| `none`
| `bucketCompletion`
| How should bucket completion be logged?
| `brief` footnote:[Except for scanner tasks, to avoid logging noise.]
|===

[%header]
[%autowidth]
|===
| Value | Meaning
| `none`
| Event should not be logged.
| `brief`
| Event should be logged briefly, typically by writing a single log line.
| `full`
| Event should be logged fully. A couple of lines containing e.g. statistical information can be written.
|===

We are also thinking about the possibility of overriding specific logging levels for given activity,
just like it is possible even today during tracing (e.g. log all model-impl issues at DEBUG level).
Maybe such custom logs could be also forwarded to a separate report, to be directly downloadable?

== Tracing Configuration

Here we configure the link:/midpoint/reference/diag/troubleshooting/troubleshooting-with-traces/[tracing feature] for the activity.

WARNING: This feature is *experimental*.

TIP: Unlike 4.3 and earlier, we can now provide more tracing configurations, e.g. brief tracing for each 10-th item, and in-depth
tracing for each 100-th item.

[%header]
[%autowidth]
|===
| Item | Meaning | Default
| `order` | Order in which this configuration is to be considered. Nulls go last. | -
| `beforeItemCondition` (multi) | Conditions that must be fulfilled (any of them) before this configuration is applied. | Start tracing.
| `afterItemCondition` (multi) | Conditions that must be fulfilled (any of them) for the result of this tracing be written to the file.

*BEWARE:* This condition is checked only for traces with the root of `iterativeTaskObjectProcessing`,
i.e. those that were started right on the level of the iterative activity.
| Write the trace.
| `tracingProfile` | Tracing profile to be used. | Obligatory.
| `tracingPoint` (multi) | Point(s) to be traced. | `iterativeTaskObjectProcessing`
|===

A combination of `beforeItemCondition` and `afterItemCondition` can be used e.g. to selectively write traces
for items that took too long or ended with a failure.

#TODO some examples#

== Profiling Configuration

Dynamic profiling is a predecessor to tracing. It logs selected methods' execution directly to the log file.
Usually, the tracing is more convenient. However, for completeness we keep this (older) method as well.

[%header]
[%autowidth]
|===
| Item | Meaning | Default
| `beforeItemCondition` (multi)
| Conditions that must be fulfilled (any of them) before dynamic profiling is started.
| Start profiling.
|===

== Execution Reports Configuration

#TODO#

[%header]
[%autowidth]
|===
| Item | Meaning | Default
|===

== Item Counting Configuration

#TODO#

[%header]
[%autowidth]
|===
| Item | Meaning | Default
|===

== State Overview Configuration

#TODO#

[%header]
[%autowidth]
|===
| Item | Meaning | Default
|===

